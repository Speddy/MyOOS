(self.webpackChunkmetaverse_experience=self.webpackChunkmetaverse_experience||[]).push([[9],{7642:t=>{t.exports=AFRAME.registerComponent("checkpoint",{schema:{offset:{default:{x:0,y:0,z:0},type:"vec3"}},init:function(){this.active=!1,this.targetEl=null,this.fire=this.fire.bind(this),this.offset=new THREE.Vector3},update:function(){this.offset.copy(this.data.offset)},play:function(){this.el.addEventListener("click",this.fire)},pause:function(){this.el.removeEventListener("click",this.fire)},remove:function(){this.pause()},fire:function(){const t=this.el.sceneEl.querySelector("[checkpoint-controls]");if(!t)throw new Error("No `checkpoint-controls` component found.");t.components["checkpoint-controls"].setCheckpoint(this.el)},getOffset:function(){return this.offset.copy(this.data.offset)}})},4795:t=>{function e(t,e,i,s){t&&(e=e||[],t.traverse((t=>{if(!t.isMesh)return;var n;((n=t.material)?Array.isArray(n)?n:n.materials?n.materials:[n]:[]).forEach((t=>{t&&!("envMap"in t)||e.length&&-1===e.indexOf(t.name)||(t.envMap=i,t.reflectivity=s,t.needsUpdate=!0)}))})))}t.exports=AFRAME.registerComponent("cube-env-map",{multiple:!0,schema:{path:{default:""},extension:{default:"jpg",oneOf:["jpg","png"]},enableBackground:{default:!1},reflectivity:{default:1,min:0,max:1},materials:{default:[]}},init:function(){const t=this.data;this.texture=(new THREE.CubeTextureLoader).load([t.path+"posx."+t.extension,t.path+"negx."+t.extension,t.path+"posy."+t.extension,t.path+"negy."+t.extension,t.path+"posz."+t.extension,t.path+"negz."+t.extension]),this.texture.format=THREE.RGBAFormat,this.object3dsetHandler=()=>{const t=this.el.getObject3D("mesh"),i=this.data;e(t,i.materials,this.texture,i.reflectivity)},this.object3dsetHandler(),this.el.addEventListener("object3dset",this.object3dsetHandler)},update:function(t){const i=this.data,s=this.el.getObject3D("mesh");let n=[],a=[];if(i.materials.length&&(t.materials?(n=i.materials.filter((e=>!t.materials.includes(e))),a=t.materials.filter((t=>!i.materials.includes(t)))):n=i.materials),n.length&&e(s,n,this.texture,i.reflectivity),a.length&&e(s,a,null,1),t.materials&&i.reflectivity!==t.reflectivity){const n=i.materials.filter((e=>t.materials.includes(e)));n.length&&e(s,n,this.texture,i.reflectivity)}this.data.enableBackground&&!t.enableBackground?this.setBackground(this.texture):!this.data.enableBackground&&t.enableBackground&&this.setBackground(null)},remove:function(){this.el.removeEventListener("object3dset",this.object3dsetHandler);const t=this.el.getObject3D("mesh"),i=this.data;e(t,i.materials,null,1),i.enableBackground&&this.setBackground(null)},setBackground:function(t){this.el.sceneEl.object3D.background=t}})},9511:t=>{t.exports=AFRAME.registerComponent("grab",{init:function(){this.system=this.el.sceneEl.systems.physics,this.GRABBED_STATE="grabbed",this.grabbing=!1,this.hitEl=null,this.physics=this.el.sceneEl.systems.physics,this.constraint=null,this.onHit=this.onHit.bind(this),this.onGripOpen=this.onGripOpen.bind(this),this.onGripClose=this.onGripClose.bind(this)},play:function(){const t=this.el;t.addEventListener("hit",this.onHit),t.addEventListener("gripdown",this.onGripClose),t.addEventListener("gripup",this.onGripOpen),t.addEventListener("trackpaddown",this.onGripClose),t.addEventListener("trackpadup",this.onGripOpen),t.addEventListener("triggerdown",this.onGripClose),t.addEventListener("triggerup",this.onGripOpen)},pause:function(){const t=this.el;t.removeEventListener("hit",this.onHit),t.removeEventListener("gripdown",this.onGripClose),t.removeEventListener("gripup",this.onGripOpen),t.removeEventListener("trackpaddown",this.onGripClose),t.removeEventListener("trackpadup",this.onGripOpen),t.removeEventListener("triggerdown",this.onGripClose),t.removeEventListener("triggerup",this.onGripOpen)},onGripClose:function(){this.grabbing=!0},onGripOpen:function(){const t=this.hitEl;this.grabbing=!1,t&&(t.removeState(this.GRABBED_STATE),this.hitEl=void 0,this.system.removeConstraint(this.constraint),this.constraint=null)},onHit:function(t){const e=t.detail.el;e.is(this.GRABBED_STATE)||!this.grabbing||this.hitEl||(e.addState(this.GRABBED_STATE),this.hitEl=e,this.constraint=new CANNON.LockConstraint(this.el.body,e.body),this.system.addConstraint(this.constraint))}})},9236:(t,e,i)=>{i(7642),i(4795),i(9511),i(8240),i(1790)},8240:t=>{t.exports=AFRAME.registerComponent("normal-material",{init:function(){this.material=new THREE.MeshNormalMaterial({flatShading:!0}),this.applyMaterial=this.applyMaterial.bind(this),this.el.addEventListener("object3dset",this.applyMaterial),this.applyMaterial()},remove:function(){this.el.removeEventListener("object3dset",this.applyMaterial)},applyMaterial:function(){this.el.object3D.traverse((t=>{t.isMesh&&(t.material=this.material)}))}})},1790:t=>{t.exports=AFRAME.registerComponent("sphere-collider",{schema:{enabled:{default:!0},interval:{default:80},objects:{default:""},state:{default:"collided"},radius:{default:.05},watch:{default:!0}},init:function(){this.observer=null,this.els=[],this.collisions=[],this.prevCheckTime=void 0,this.eventDetail={},this.handleHit=this.handleHit.bind(this),this.handleHitEnd=this.handleHitEnd.bind(this)},play:function(){const t=this.el.sceneEl;this.data.watch&&(this.observer=new MutationObserver(this.update.bind(this,null)),this.observer.observe(t,{childList:!0,subtree:!0}))},pause:function(){this.observer&&(this.observer.disconnect(),this.observer=null)},update:function(){const t=this.data;let e;e=t.objects?this.el.sceneEl.querySelectorAll(t.objects):this.el.sceneEl.children,this.els=Array.prototype.slice.call(e)},tick:function(){const t=new THREE.Vector3,e=new THREE.Vector3,i=new THREE.Vector3,s=new THREE.Vector3,n=new THREE.Box3,a=[],o=new Map;return function(r){if(!this.data.enabled)return;const h=this.prevCheckTime;if(h&&r-h<this.data.interval)return;this.prevCheckTime=r;const l=this.el,c=this.data;let d;var p;l.getObject3D("mesh")&&(a.length=0,o.clear(),l.object3D.getWorldPosition(t),l.object3D.getWorldScale(i),d=c.radius*(p=i,Math.max(p.x,p.y,p.z)),this.els.forEach((function(i){let r,h,l,c;if(!i.isEntity)return;if(h=i.getObject3D("mesh"),!h)return;if(n.setFromObject(h).getSize(s),c=Math.max(s.x,s.y,s.z)/2,r=Math.sqrt(2*c*c),n.getCenter(e),!r)return;l=t.distanceTo(e),l<r+d&&(a.push(i),o.set(i,l))})),a.sort(((t,e)=>o.get(t)>o.get(e)?1:-1)).forEach(this.handleHit),this.collisions.filter((t=>!o.has(t))).forEach(this.handleHitEnd),function(t,e){t.length=0;for(let i=0;i<e.length;i++)t[i]=e[i]}(this.collisions,a))}}(),handleHit:function(t){t.emit("hit"),t.addState(this.data.state),this.eventDetail.el=t,this.el.emit("hit",this.eventDetail)},handleHitEnd:function(t){t.emit("hitend"),t.removeState(this.data.state),this.eventDetail.el=t,this.el.emit("hitend",this.eventDetail)}})},2578:(t,e,i)=>{i(8453),i(1250),i(1465)},1250:t=>{t.exports=AFRAME.registerComponent("nav-agent",{schema:{destination:{type:"vec3"},active:{default:!1},speed:{default:2}},init:function(){this.system=this.el.sceneEl.systems.nav,this.system.addAgent(this),this.group=null,this.path=[],this.raycaster=new THREE.Raycaster},remove:function(){this.system.removeAgent(this)},update:function(){this.path.length=0},updateNavLocation:function(){this.group=null,this.path=[]},tick:function(){const t=new THREE.Vector3,e=new THREE.Vector3,i=new THREE.Vector3;return function(s,n){const a=this.el,o=this.data,r=this.raycaster,h=o.speed*n/1e3;if(!o.active)return;if(!this.path.length){const e=this.el.object3D.position;this.group=this.group||this.system.getGroup(e),this.path=this.system.getPath(e,t.copy(o.destination),this.group)||[],a.emit("navigation-start")}if(!this.path.length)return console.warn("[nav] Unable to find path to %o.",o.destination),this.el.setAttribute("nav-agent",{active:!1}),void a.emit("navigation-end");const l=a.object3D.position,c=this.path[0];e.subVectors(c,l);let d;if(e.length()<h){if(this.path.shift(),!this.path.length)return this.el.setAttribute("nav-agent",{active:!1}),void a.emit("navigation-end");i.copy(l),d=this.path[0]}else i.copy(e.setLength(h)).add(l),d=c;d.y=l.y,a.object3D.lookAt(d),r.ray.origin.copy(i),r.ray.origin.y+=1.5,r.ray.direction={x:0,y:-1,z:0};const p=r.intersectObject(this.system.getNavMesh());p.length?(e.subVectors(p[0].point,l),l.add(e.setLength(h))):l.copy(i)}}()})},8453:t=>{t.exports=AFRAME.registerComponent("nav-mesh",{schema:{nodeName:{type:"string"}},init:function(){this.system=this.el.sceneEl.systems.nav,this.hasLoadedNavMesh=!1,this.nodeName=this.data.nodeName,this.el.addEventListener("object3dset",this.loadNavMesh.bind(this))},play:function(){this.hasLoadedNavMesh||this.loadNavMesh()},loadNavMesh:function(){var t=this;const e=this.el.getObject3D("mesh");this.el.sceneEl.object3D;if(!e)return;let i;if(e.traverse((e=>{!e.isMesh||t.nodeName&&e.name!==t.nodeName||(i=e)})),!i)return;const s=i.geometry.clone();i.updateWorldMatrix(!0,!1),s.applyMatrix4(i.matrixWorld),this.system.setNavMeshGeometry(s),this.hasLoadedNavMesh=!0}})},1465:(t,e,i)=>{const{Pathfinding:s}=i(6594),n=new s,a="level";t.exports=AFRAME.registerSystem("nav",{init:function(){this.navMesh=null,this.agents=new Set},setNavMeshGeometry:function(t){this.navMesh=new THREE.Mesh(t),n.setZoneData(a,s.createZone(t)),Array.from(this.agents).forEach((t=>t.updateNavLocation()))},getNavMesh:function(){return this.navMesh},addAgent:function(t){this.agents.add(t)},removeAgent:function(t){this.agents.delete(t)},getPath:function(t,e,i){return this.navMesh?n.findPath(t,e,a,i):null},getGroup:function(t){return this.navMesh?n.getGroup(a,t):null},getNode:function(t,e){return this.navMesh?n.getClosestNode(t,a,e,!0):null},clampStep:function(t,e,i,s,o){return this.navMesh?s?n.clampStep(t,e,s,a,i,o):(o.copy(e),this.getNode(e,i)):(o.copy(e),null)}})},386:t=>{t.exports=AFRAME.registerPrimitive("a-grid",{defaultComponents:{geometry:{primitive:"plane",width:75,height:75},rotation:{x:-90,y:0,z:0},material:{src:"url(https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v1.16.3/assets/grid.png)",repeat:"75 75"}},mappings:{width:"geometry.width",height:"geometry.height",src:"material.src"}})},9307:t=>{t.exports.Primitive=AFRAME.registerPrimitive("a-ocean",{defaultComponents:{ocean:{},rotation:{x:-90,y:0,z:0}},mappings:{width:"ocean.width",depth:"ocean.depth",density:"ocean.density",amplitude:"ocean.amplitude",amplitudeVariance:"ocean.amplitudeVariance",speed:"ocean.speed",speedVariance:"ocean.speedVariance",color:"ocean.color",opacity:"ocean.opacity"}}),t.exports.Component=AFRAME.registerComponent("ocean",{schema:{width:{default:10,min:0},depth:{default:10,min:0},density:{default:10},amplitude:{default:.1},amplitudeVariance:{default:.3},speed:{default:1},speedVariance:{default:2},color:{default:"#7AD2F7",type:"color"},opacity:{default:.8}},play:function(){const t=this.el,e=this.data;let i=t.components.material;const s=new THREE.PlaneGeometry(e.width,e.depth,e.density,e.density);this.waves=[];const n=s.getAttribute("position");for(let t=0;t<n.count;t++)this.waves.push({z:n.getZ(t),ang:Math.random()*Math.PI*2,amp:e.amplitude+Math.random()*e.amplitudeVariance,speed:(e.speed+Math.random()*e.speedVariance)/1e3});i||(i={},i.material=new THREE.MeshPhongMaterial({color:e.color,transparent:e.opacity<1,opacity:e.opacity,flatShading:!0})),this.mesh=new THREE.Mesh(s,i.material),t.setObject3D("mesh",this.mesh)},remove:function(){this.el.removeObject3D("mesh")},tick:function(t,e){if(!e)return;const i=this.mesh.geometry.getAttribute("position");for(let t=0;t<i.count;t++){const s=this.waves[t],n=s.z+Math.sin(s.ang)*s.amp;i.setZ(t,n),s.ang+=s.speed*e}i.needsUpdate=!0}})},699:t=>{t.exports.Primitive=AFRAME.registerPrimitive("a-tube",{defaultComponents:{tube:{}},mappings:{path:"tube.path",segments:"tube.segments",radius:"tube.radius","radial-segments":"tube.radialSegments",closed:"tube.closed"}}),t.exports.Component=AFRAME.registerComponent("tube",{schema:{path:{default:[]},segments:{default:64},radius:{default:1},radialSegments:{default:8},closed:{default:!1}},init:function(){const t=this.el,e=this.data;let i=t.components.material;if(!e.path.length)return void console.error("[a-tube] `path` property expected but not found.");const s=new THREE.CatmullRomCurve3(e.path.map((function(t){return t=t.split(" "),new THREE.Vector3(Number(t[0]),Number(t[1]),Number(t[2]))}))),n=new THREE.TubeGeometry(s,e.segments,e.radius,e.radialSegments,e.closed);i||(i={},i.material=new THREE.MeshPhongMaterial),this.mesh=new THREE.Mesh(n,i.material),this.el.setObject3D("mesh",this.mesh)},update:function(t){Object.keys(t).length&&(this.remove(),this.init())},remove:function(){this.mesh&&this.el.removeObject3D("mesh")}})},6699:(t,e,i)=>{i(386),i(9307),i(699)},6261:()=>{AFRAME.registerComponent("stats-panel",{schema:{merge:{type:"boolean",default:!0}},init(){const t=document.querySelector(".rs-container");if(t&&this.data.merge)return void(this.container=t);this.base=document.createElement("div"),this.base.classList.add("rs-base");const e=document.body||document.getElementsByTagName("body")[0];t&&!this.data.merge&&(this.base.style.top="auto",this.base.style.bottom="20px"),e.appendChild(this.base),this.container=document.createElement("div"),this.container.classList.add("rs-container"),this.base.appendChild(this.container)}}),AFRAME.registerComponent("stats-group",{multiple:!0,schema:{label:{type:"string"}},init(){let t;const e=this.el.components["stats-panel"];t=e?e.container:document.querySelector(".rs-container"),t?(this.groupHeader=document.createElement("h1"),this.groupHeader.innerHTML=this.data.label,t.appendChild(this.groupHeader),this.group=document.createElement("div"),this.group.classList.add("rs-group"),this.group.style.flexDirection="column",this.group.style.webKitFlexDirection="column",t.appendChild(this.group)):console.warn("Couldn't find stats container to add stats to.\n                    Add either stats or stats-panel component to a-scene")}}),AFRAME.registerComponent("stats-row",{multiple:!0,schema:{group:{type:"string"},event:{type:"string"},properties:{type:"array"},label:{type:"string"}},init(){const t="stats-group__"+this.data.group,e=this.el.components[t]||this.el.sceneEl.components[t]||this.el.components["stats-group"]||this.el.sceneEl.components["stats-group"];e?(this.counter=document.createElement("div"),this.counter.classList.add("rs-counter-base"),e.group.appendChild(this.counter),this.counterId=document.createElement("div"),this.counterId.classList.add("rs-counter-id"),this.counterId.innerHTML=this.data.label,this.counter.appendChild(this.counterId),this.counterValues={},this.data.properties.forEach((t=>{const e=document.createElement("div");e.classList.add("rs-counter-value"),e.innerHTML="...",this.counter.appendChild(e),this.counterValues[t]=e})),this.updateData=this.updateData.bind(this),this.el.addEventListener(this.data.event,this.updateData),this.splitCache={}):console.warn(`Couldn't find stats group ${t}`)},updateData(t){this.data.properties.forEach((e=>{const s=this.splitDot(e);let n=t.detail;for(i=0;i<s.length;i++)n=n[s[i]];this.counterValues[e].innerHTML=n}))},splitDot(t){return t in this.splitCache||(this.splitCache[t]=t.split(".")),this.splitCache[t]}}),AFRAME.registerComponent("stats-collector",{multiple:!0,schema:{inEvent:{type:"string"},properties:{type:"array"},outputFrequency:{type:"number",default:100},outEvent:{type:"string"},outputs:{type:"array"},outputToConsole:{type:"string"}},init(){this.statsData={},this.resetData(),this.outputDetail={},this.data.properties.forEach((t=>{this.outputDetail[t]={}})),this.statsReceived=this.statsReceived.bind(this),this.el.addEventListener(this.data.inEvent,this.statsReceived)},resetData(){this.counter=0,this.data.properties.forEach((t=>{this.statsData[t]=[]}))},statsReceived(t){this.updateData(t.detail),this.counter++,this.counter===this.data.outputFrequency&&(this.outputData(),this.resetData())},updateData(t){this.data.properties.forEach((e=>{let i=t;i=i[e],this.statsData[e].push(i)}))},outputData(){this.data.properties.forEach((t=>{this.data.outputs.forEach((e=>{this.outputDetail[t][e]=this.computeOutput(e,this.statsData[t])}))})),this.data.outEvent&&this.el.emit(this.data.outEvent,this.outputDetail),this.data.outputToConsole&&console.log(this.data.outputToConsole,this.outputDetail)},computeOutput(t,e){const i=t.split("__");let s;switch(i[0]){case"mean":s=e.reduce(((t,e)=>t+e),0)/e.length;break;case"max":s=Math.max(...e);break;case"min":s=Math.min(...e);break;case"percentile":const t=e.sort(((t,e)=>t-e)),n=+i[1].replace("_",".")/100,a=(e.length-1)*n,o=Math.floor(a),r=a-o;s=void 0!==t[o+1]?t[o]+r*(t[o+1]-t[o]):t[o]}return s.toFixed(2)}})}}]);