(self.webpackChunkmetaverse_experience=self.webpackChunkmetaverse_experience||[]).push([[503],{2182:function(e,t,i){i(3687);var r=i(1389),n=r.GRAVITY,a=r.CONTACT_MATERIAL,o=i(598),s=i(7810),u=i(8254),l=i(6203);e.exports=AFRAME.registerSystem("physics",{schema:{driver:{default:"local",oneOf:["local","worker","network","ammo"]},networkUrl:{default:"",if:{driver:"network"}},workerFps:{default:60,if:{driver:"worker"}},workerInterpolate:{default:!0,if:{driver:"worker"}},workerInterpBufferSize:{default:2,if:{driver:"worker"}},workerEngine:{default:"cannon",if:{driver:"worker"},oneOf:["cannon"]},workerDebug:{default:!1,if:{driver:"worker"}},gravity:{default:n},iterations:{default:r.ITERATIONS},friction:{default:a.friction},restitution:{default:a.restitution},contactEquationStiffness:{default:a.contactEquationStiffness},contactEquationRelaxation:{default:a.contactEquationRelaxation},frictionEquationStiffness:{default:a.frictionEquationStiffness},frictionEquationRegularization:{default:a.frictionEquationRegularization},maxInterval:{default:4/60},debug:{default:!1},debugDrawMode:{default:THREE.AmmoDebugConstants.NoDebug},maxSubSteps:{default:4},fixedTimeStep:{default:1/60}},async init(){var e=this.data;switch(this.debug=e.debug,this.callbacks={beforeStep:[],step:[],afterStep:[]},this.listeners={},this.driver=null,e.driver){case"local":this.driver=new o;break;case"ammo":this.driver=new l;break;case"network":this.driver=new u(e.networkUrl);break;case"worker":this.driver=new s({fps:e.workerFps,engine:e.workerEngine,interpolate:e.workerInterpolate,interpolationBufferSize:e.workerInterpBufferSize,debug:e.workerDebug});break;default:throw new Error('[physics] Driver not recognized: "%s".',e.driver)}"ammo"!==e.driver?(await this.driver.init({quatNormalizeSkip:0,quatNormalizeFast:!1,solverIterations:e.iterations,gravity:e.gravity}),this.driver.addMaterial({name:"defaultMaterial"}),this.driver.addMaterial({name:"staticMaterial"}),this.driver.addContactMaterial("defaultMaterial","defaultMaterial",{friction:e.friction,restitution:e.restitution,contactEquationStiffness:e.contactEquationStiffness,contactEquationRelaxation:e.contactEquationRelaxation,frictionEquationStiffness:e.frictionEquationStiffness,frictionEquationRegularization:e.frictionEquationRegularization}),this.driver.addContactMaterial("staticMaterial","defaultMaterial",{friction:1,restitution:0,contactEquationStiffness:e.contactEquationStiffness,contactEquationRelaxation:e.contactEquationRelaxation,frictionEquationStiffness:e.frictionEquationStiffness,frictionEquationRegularization:e.frictionEquationRegularization})):await this.driver.init({gravity:e.gravity,debugDrawMode:e.debugDrawMode,solverIterations:e.iterations,maxSubSteps:e.maxSubSteps,fixedTimeStep:e.fixedTimeStep}),this.initialized=!0,this.debug&&this.setDebug(!0)},tick:function(e,t){if(this.initialized&&t){var i,r=this.callbacks;for(i=0;i<this.callbacks.beforeStep.length;i++)this.callbacks.beforeStep[i].beforeStep(e,t);for(this.driver.step(Math.min(t/1e3,this.data.maxInterval)),i=0;i<r.step.length;i++)r.step[i].step(e,t);for(i=0;i<r.afterStep.length;i++)r.afterStep[i].afterStep(e,t)}},setDebug:function(e){this.debug=e,"ammo"===this.data.driver&&this.initialized&&(e&&!this.debugDrawer?(this.debugDrawer=this.driver.getDebugDrawer(this.el.object3D),this.debugDrawer.enable()):this.debugDrawer&&(this.debugDrawer.disable(),this.debugDrawer=null))},addBody:function(e,t,i){var r=this.driver;"local"===this.data.driver&&(e.__applyImpulse=e.applyImpulse,e.applyImpulse=function(){r.applyBodyMethod(e,"applyImpulse",arguments)},e.__applyForce=e.applyForce,e.applyForce=function(){r.applyBodyMethod(e,"applyForce",arguments)},e.updateProperties=function(){r.updateBodyProperties(e)},this.listeners[e.id]=function(t){e.el.emit("collide",t)},e.addEventListener("collide",this.listeners[e.id])),this.driver.addBody(e,t,i)},removeBody:function(e){this.driver.removeBody(e),"local"!==this.data.driver&&"worker"!==this.data.driver||(e.removeEventListener("collide",this.listeners[e.id]),delete this.listeners[e.id],e.applyImpulse=e.__applyImpulse,delete e.__applyImpulse,e.applyForce=e.__applyForce,delete e.__applyForce,delete e.updateProperties)},addConstraint:function(e){this.driver.addConstraint(e)},removeConstraint:function(e){this.driver.removeConstraint(e)},addComponent:function(e){var t=this.callbacks;e.beforeStep&&t.beforeStep.push(e),e.step&&t.step.push(e),e.afterStep&&t.afterStep.push(e)},removeComponent:function(e){var t=this.callbacks;e.beforeStep&&t.beforeStep.splice(t.beforeStep.indexOf(e),1),e.step&&t.step.splice(t.step.indexOf(e),1),e.afterStep&&t.afterStep.splice(t.afterStep.indexOf(e),1)},getContacts:function(){return this.driver.getContacts()},getMaterial:function(e){return this.driver.getMaterial(e)}})},7558:function(e){e.exports.slerp=function(e,t,i){if(i<=0)return e;if(i>=1)return t;var r=e[0],n=e[1],a=e[2],o=e[3],s=o*t[3]+r*t[0]+n*t[1]+a*t[2];if(!(s<0))return t;if((e=e.slice())[3]=-t[3],e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],(s=-s)>=1)return e[3]=o,e[0]=r,e[1]=n,e[2]=a,this;var u=Math.sqrt(1-s*s);if(Math.abs(u)<.001)return e[3]=.5*(o+e[3]),e[0]=.5*(r+e[0]),e[1]=.5*(n+e[1]),e[2]=.5*(a+e[2]),this;var l=Math.atan2(u,s),p=Math.sin((1-i)*l)/u,d=Math.sin(i*l)/u;return e[3]=o*p+e[3]*d,e[0]=r*p+e[0]*d,e[1]=n*p+e[1]*d,e[2]=a*p+e[2]*d,e}},779:function(e,t,i){var r=i(3687),n=i(7558),a="__id";e.exports.ID=a;var o={};function s(e){var t={type:e.type};if(e.type===r.Shape.types.BOX)t.halfExtents=l(e.halfExtents);else if(e.type===r.Shape.types.SPHERE)t.radius=e.radius;else{if(e._type!==r.Shape.types.CYLINDER)throw new Error("Unimplemented shape type: %s",e.type);t.type=r.Shape.types.CYLINDER,t.radiusTop=e.radiusTop,t.radiusBottom=e.radiusBottom,t.height=e.height,t.numSegments=e.numSegments}return t}function u(e){var t;if(e.type===r.Shape.types.BOX)t=new r.Box(p(e.halfExtents));else if(e.type===r.Shape.types.SPHERE)t=new r.Sphere(e.radius);else{if(e.type!==r.Shape.types.CYLINDER)throw new Error("Unimplemented shape type: %s",e.type);(t=new r.Cylinder(e.radiusTop,e.radiusBottom,e.height,e.numSegments))._type=r.Shape.types.CYLINDER}return t}function l(e){return e.toArray()}function p(e){return new r.Vec3(e[0],e[1],e[2])}function d(e){return e.toArray()}function c(e){return new r.Quaternion(e[0],e[1],e[2],e[3])}e.exports.assignID=function(e,t){t[a]||(o[e]=o[e]||1,t[a]=e+"_"+o[e]++)},e.exports.serializeBody=function(e){return{shapes:e.shapes.map(s),shapeOffsets:e.shapeOffsets.map(l),shapeOrientations:e.shapeOrientations.map(d),position:l(e.position),quaternion:e.quaternion.toArray(),velocity:l(e.velocity),angularVelocity:l(e.angularVelocity),id:e[a],mass:e.mass,linearDamping:e.linearDamping,angularDamping:e.angularDamping,fixedRotation:e.fixedRotation,allowSleep:e.allowSleep,sleepSpeedLimit:e.sleepSpeedLimit,sleepTimeLimit:e.sleepTimeLimit}},e.exports.deserializeBodyUpdate=function(e,t){return t.position.set(e.position[0],e.position[1],e.position[2]),t.quaternion.set(e.quaternion[0],e.quaternion[1],e.quaternion[2],e.quaternion[3]),t.velocity.set(e.velocity[0],e.velocity[1],e.velocity[2]),t.angularVelocity.set(e.angularVelocity[0],e.angularVelocity[1],e.angularVelocity[2]),t.linearDamping=e.linearDamping,t.angularDamping=e.angularDamping,t.fixedRotation=e.fixedRotation,t.allowSleep=e.allowSleep,t.sleepSpeedLimit=e.sleepSpeedLimit,t.sleepTimeLimit=e.sleepTimeLimit,t.mass!==e.mass&&(t.mass=e.mass,t.updateMassProperties()),t},e.exports.deserializeInterpBodyUpdate=function(e,t,i,r){var a=1-r,o=r;i.position.set(e.position[0]*a+t.position[0]*o,e.position[1]*a+t.position[1]*o,e.position[2]*a+t.position[2]*o);var s=n.slerp(e.quaternion,t.quaternion,r);return i.quaternion.set(s[0],s[1],s[2],s[3]),i.velocity.set(e.velocity[0]*a+t.velocity[0]*o,e.velocity[1]*a+t.velocity[1]*o,e.velocity[2]*a+t.velocity[2]*o),i.angularVelocity.set(e.angularVelocity[0]*a+t.angularVelocity[0]*o,e.angularVelocity[1]*a+t.angularVelocity[1]*o,e.angularVelocity[2]*a+t.angularVelocity[2]*o),i.linearDamping=t.linearDamping,i.angularDamping=t.angularDamping,i.fixedRotation=t.fixedRotation,i.allowSleep=t.allowSleep,i.sleepSpeedLimit=t.sleepSpeedLimit,i.sleepTimeLimit=t.sleepTimeLimit,i.mass!==t.mass&&(i.mass=t.mass,i.updateMassProperties()),i},e.exports.deserializeBody=function(e){for(var t,i=new r.Body({mass:e.mass,position:p(e.position),quaternion:c(e.quaternion),velocity:p(e.velocity),angularVelocity:p(e.angularVelocity),linearDamping:e.linearDamping,angularDamping:e.angularDamping,fixedRotation:e.fixedRotation,allowSleep:e.allowSleep,sleepSpeedLimit:e.sleepSpeedLimit,sleepTimeLimit:e.sleepTimeLimit}),n=0;t=e.shapes[n];n++)i.addShape(u(t),p(e.shapeOffsets[n]),c(e.shapeOrientations[n]));return i[a]=e.id,i},e.exports.serializeShape=s,e.exports.deserializeShape=u,e.exports.serializeConstraint=function(e){var t={id:e[a],type:e.type,maxForce:e.maxForce,bodyA:e.bodyA[a],bodyB:e.bodyB[a]};switch(e.type){case"LockConstraint":break;case"DistanceConstraint":t.distance=e.distance;break;case"HingeConstraint":case"ConeTwistConstraint":t.axisA=l(e.axisA),t.axisB=l(e.axisB),t.pivotA=l(e.pivotA),t.pivotB=l(e.pivotB);break;case"PointToPointConstraint":t.pivotA=l(e.pivotA),t.pivotB=l(e.pivotB);break;default:throw new Error("Unexpected constraint type: "+e.type+'. You may need to manually set `constraint.type = "FooConstraint";`.')}return t},e.exports.deserializeConstraint=function(e,t){var i,n=r[e.type],o=t[e.bodyA],s=t[e.bodyB];switch(e.type){case"LockConstraint":i=new r.LockConstraint(o,s,e);break;case"DistanceConstraint":i=new r.DistanceConstraint(o,s,e.distance,e.maxForce);break;case"HingeConstraint":case"ConeTwistConstraint":i=new n(o,s,{pivotA:p(e.pivotA),pivotB:p(e.pivotB),axisA:p(e.axisA),axisB:p(e.axisB),maxForce:e.maxForce});break;case"PointToPointConstraint":i=new r.PointToPointConstraint(o,p(e.pivotA),s,p(e.pivotB),e.maxForce);break;default:throw new Error("Unexpected constraint type: "+e.type)}return i[a]=e.id,i},e.exports.serializeContact=function(e){return{bi:e.bi[a],bj:e.bj[a],ni:l(e.ni),ri:l(e.ri),rj:l(e.rj)}},e.exports.deserializeContact=function(e,t){return{bi:t[e.bi],bj:t[e.bj],ni:p(e.ni),ri:p(e.ri),rj:p(e.rj)}},e.exports.serializeVec3=l,e.exports.deserializeVec3=p,e.exports.serializeQuaternion=d,e.exports.deserializeQuaternion=c},9938:function(e,t,i){"use strict";var r,n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},a=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),o=i(7294),s=(r=o)&&r.__esModule?r:{default:r};function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var d=["children","events","primitive"],c=function(e){return-1===d.indexOf(e)},f={runSetAttributeOnUpdates:!0};function h(e,t,i){if("className"===i)e.setAttribute("class",t.className);else{if(t[i]&&t[i].constructor===Function)return;e.setAttribute(i,t[i])}}function m(e,t,i){var r;if(i&&t!==i){for(r in i)c(r)&&h(e,i,r);if(t)for(r in t)c(r)&&void 0===i[r]&&e.removeAttribute(r)}}var b=function(e){function t(){var e,i,r;u(this,t);for(var n=arguments.length,a=Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=r=l(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),r.initEntity=function(e){var t,i=r.props;if(e){if(r.el=e,i.events)for(t in i.events)g(e,t,i.events[t]);m(e,null,i),i._ref&&i._ref(e)}},l(r,i)}return p(t,e),a(t,[{key:"componentDidUpdate",value:function(e,t){var i=this.el,r=this.props;!function(e,t,i){var r;if(!t||!i||t===i)return;for(r in i)t[r]!==i[r]&&(t[r]&&y(e,r,t[r]),g(e,r,i[r]));for(r in t)i[r]||y(e,r,t[r])}(i,e.events,r.events),f.runSetAttributeOnUpdates&&m(i,e,r)}},{key:"componentWillUnmount",value:function(){var e,t=this.el,i=this.props;if(i.events)for(e in i.events)y(t,e,i.events[e])}},{key:"render",value:function(){var e,t=this.props,i=this.isScene?"a-scene":t.primitive||"a-entity",r={};for(e in t)-1===["className","id","mixin"].indexOf(e)&&0!==e.indexOf("data-")||(r[e]=t[e]);return s.default.createElement(i,n({ref:this.initEntity},r),t.children)}}]),t}(s.default.Component);!function(e){function t(e){u(this,t);var i=l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.isScene=!0,i}p(t,e)}(b);function g(e,t,i){var r;if(i)for(i.constructor===Function&&(i=[i]),r=0;r<i.length;r++)e.addEventListener(t,i[r])}function y(e,t,i){var r;if(i)for(i.constructor===Function&&(i=[i]),r=0;r<i.length;r++)e.removeEventListener(t,i[r])}},2694:function(){THREE.AmmoDebugConstants={NoDebug:0,DrawWireframe:1,DrawAabb:2,DrawFeaturesText:4,DrawContactPoints:8,NoDeactivation:16,NoHelpText:32,DrawText:64,ProfileTimings:128,EnableSatComparison:256,DisableBulletLCP:512,EnableCCD:1024,DrawConstraints:2048,DrawConstraintLimits:4096,FastWireframe:8192,DrawNormals:16384,DrawOnTop:32768,MAX_DEBUG_DRAW_MODE:4294967295},THREE.AmmoDebugDrawer=function(e,t,i){this.scene=e,this.world=t,i=i||{},this.debugDrawMode=i.debugDrawMode||THREE.AmmoDebugConstants.DrawWireframe;var r=this.debugDrawMode&THREE.AmmoDebugConstants.DrawOnTop||!1,n=i.maxBufferSize||1e6;this.geometry=new THREE.BufferGeometry;var a=new Float32Array(3*n),o=new Float32Array(3*n);this.geometry.addAttribute("position",new THREE.BufferAttribute(a,3).setDynamic(!0)),this.geometry.addAttribute("color",new THREE.BufferAttribute(o,3).setDynamic(!0)),this.index=0;var s=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors,depthTest:!r});this.mesh=new THREE.LineSegments(this.geometry,s),r&&(this.mesh.renderOrder=999),this.mesh.frustumCulled=!1,this.enabled=!1,this.debugDrawer=new Ammo.DebugDrawer,this.debugDrawer.drawLine=this.drawLine.bind(this),this.debugDrawer.drawContactPoint=this.drawContactPoint.bind(this),this.debugDrawer.reportErrorWarning=this.reportErrorWarning.bind(this),this.debugDrawer.draw3dText=this.draw3dText.bind(this),this.debugDrawer.setDebugMode=this.setDebugMode.bind(this),this.debugDrawer.getDebugMode=this.getDebugMode.bind(this),this.debugDrawer.enable=this.enable.bind(this),this.debugDrawer.disable=this.disable.bind(this),this.debugDrawer.update=this.update.bind(this),this.world.setDebugDrawer(this.debugDrawer)},THREE.AmmoDebugDrawer.prototype=function(){return this.debugDrawer},THREE.AmmoDebugDrawer.prototype.enable=function(){this.enabled=!0,this.scene.add(this.mesh)},THREE.AmmoDebugDrawer.prototype.disable=function(){this.enabled=!1,this.scene.remove(this.mesh)},THREE.AmmoDebugDrawer.prototype.update=function(){this.enabled&&(0!=this.index&&(this.geometry.attributes.position.needsUpdate=!0,this.geometry.attributes.color.needsUpdate=!0),this.index=0,this.world.debugDrawWorld(),this.geometry.setDrawRange(0,this.index))},THREE.AmmoDebugDrawer.prototype.drawLine=function(e,t,i){const r=Ammo.HEAPF32,n=r[(i+0)/4],a=r[(i+4)/4],o=r[(i+8)/4],s=r[(e+0)/4],u=r[(e+4)/4],l=r[(e+8)/4];this.geometry.attributes.position.setXYZ(this.index,s,u,l),this.geometry.attributes.color.setXYZ(this.index++,n,a,o);const p=r[(t+0)/4],d=r[(t+4)/4],c=r[(t+8)/4];this.geometry.attributes.position.setXYZ(this.index,p,d,c),this.geometry.attributes.color.setXYZ(this.index++,n,a,o)},THREE.AmmoDebugDrawer.prototype.drawContactPoint=function(e,t,i,r,n){const a=Ammo.HEAPF32,o=a[(n+0)/4],s=a[(n+4)/4],u=a[(n+8)/4],l=a[(e+0)/4],p=a[(e+4)/4],d=a[(e+8)/4];this.geometry.attributes.position.setXYZ(this.index,l,p,d),this.geometry.attributes.color.setXYZ(this.index++,o,s,u);const c=a[(t+0)/4]*i,f=a[(t+4)/4]*i,h=a[(t+8)/4]*i;this.geometry.attributes.position.setXYZ(this.index,l+c,p+f,d+h),this.geometry.attributes.color.setXYZ(this.index++,o,s,u)},THREE.AmmoDebugDrawer.prototype.reportErrorWarning=function(e){Ammo.hasOwnProperty("Pointer_stringify")?console.warn(Ammo.Pointer_stringify(e)):this.warnedOnce||(this.warnedOnce=!0,console.warn("Cannot print warningString, please rebuild Ammo.js using 'debug' flag"))},THREE.AmmoDebugDrawer.prototype.draw3dText=function(e,t){console.warn("TODO: draw3dText")},THREE.AmmoDebugDrawer.prototype.setDebugMode=function(e){this.debugDrawMode=e},THREE.AmmoDebugDrawer.prototype.getDebugMode=function(){return this.debugDrawMode}}}]);