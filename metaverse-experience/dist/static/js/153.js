"use strict";(self.webpackChunkmetaverse_experience=self.webpackChunkmetaverse_experience||[]).push([[153],{8153:function(e,t,n){n.d(t,{A:function(){return fe},B:function(){return C},C:function(){return pe},D:function(){return he},E:function(){return P},a:function(){return w},b:function(){return Pe},c:function(){return $},d:function(){return je},e:function(){return d},f:function(){return N},g:function(){return Ee},h:function(){return be},i:function(){return b},j:function(){return we},k:function(){return A},l:function(){return ge},m:function(){return ye},n:function(){return ee},o:function(){return te},p:function(){return ne},q:function(){return oe},r:function(){return Se},s:function(){return x},t:function(){return f},u:function(){return _},v:function(){return Oe},w:function(){return me},x:function(){return ce},y:function(){return le},z:function(){return ue}});var r=n(9477),o=n(7294),i=n(2576),a=n(8581),s=n(6525),c=n.n(s),l=n(3840),u=n(8139),f=Object.freeze({__proto__:null});const p={},d=e=>{Object.assign(p,e)};var v,h;const m=e=>"colorSpace"in e||"outputColorSpace"in e,g=()=>{var e;return null!=(e=p.ColorManagement)?e:null},y=e=>e&&e.isOrthographicCamera,b=e=>e&&e.hasOwnProperty("current"),w="undefined"!=typeof window&&(null!=(v=window.document)&&v.createElement||"ReactNative"===(null==(h=window.navigator)?void 0:h.product))?o.useLayoutEffect:o.useEffect;function _(e){const t=o.useRef(e);return w((()=>{t.current=e}),[e]),t}function C({set:e}){return w((()=>(e(new Promise((()=>null))),()=>e(!1))),[e]),null}class P extends o.Component{constructor(...e){super(...e),this.state={error:!1}}componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}}P.getDerivedStateFromError=()=>({error:!0});const S="__default",M=new Map,j=e=>e&&!!e.memoized&&!!e.changes;function E(e){var t;const n="undefined"!=typeof window?null!=(t=window.devicePixelRatio)?t:2:1;return Array.isArray(e)?Math.min(Math.max(e[0],n),e[1]):e}const x=e=>{var t;return null==(t=e.__r3f)?void 0:t.root.getState()},O={obj:e=>e===Object(e)&&!O.arr(e)&&"function"!=typeof e,fun:e=>"function"==typeof e,str:e=>"string"==typeof e,num:e=>"number"==typeof e,boo:e=>"boolean"==typeof e,und:e=>void 0===e,arr:e=>Array.isArray(e),equ(e,t,{arrays:n="shallow",objects:r="reference",strict:o=!0}={}){if(typeof e!=typeof t||!!e!=!!t)return!1;if(O.str(e)||O.num(e))return e===t;const i=O.obj(e);if(i&&"reference"===r)return e===t;const a=O.arr(e);if(a&&"reference"===n)return e===t;if((a||i)&&e===t)return!0;let s;for(s in e)if(!(s in t))return!1;if(i&&"shallow"===n&&"shallow"===r){for(s in o?t:e)if(!O.equ(e[s],t[s],{strict:o,objects:"reference"}))return!1}else for(s in o?t:e)if(e[s]!==t[s])return!1;if(O.und(s)){if(a&&0===e.length&&0===t.length)return!0;if(i&&0===Object.keys(e).length&&0===Object.keys(t).length)return!0;if(e!==t)return!1}return!0}};function k(e){const t={nodes:{},materials:{}};return e&&e.traverse((e=>{e.name&&(t.nodes[e.name]=e),e.material&&!t.materials[e.material.name]&&(t.materials[e.material.name]=e.material)})),t}function A(e){e.dispose&&"Scene"!==e.type&&e.dispose();for(const t in e)null==t.dispose||t.dispose(),delete e[t]}function z(e,t){return e.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...t},e}function T(e,t){let n=e;if(t.includes("-")){const r=t.split("-"),o=r.pop();return n=r.reduce(((e,t)=>e[t]),e),{target:n,key:o}}return{target:n,key:t}}const R=/-\d+$/;function D(e,t,n){if(O.str(n)){if(R.test(n)){const t=n.replace(R,""),{target:r,key:o}=T(e,t);Array.isArray(r[o])||(r[o]=[])}const{target:r,key:o}=T(e,n);t.__r3f.previousAttach=r[o],r[o]=t}else t.__r3f.previousAttach=n(e,t)}function I(e,t,n){var r,o;if(O.str(n)){const{target:r,key:o}=T(e,n),i=t.__r3f.previousAttach;void 0===i?delete r[o]:r[o]=i}else null==(r=t.__r3f)||null==r.previousAttach||r.previousAttach(e,t);null==(o=t.__r3f)||delete o.previousAttach}function F(e,{children:t,key:n,ref:r,...o},{children:i,key:a,ref:s,...c}={},l=!1){var u;const f=null!=(u=null==e?void 0:e.__r3f)?u:{},p=Object.entries(o),d=[];if(l){const e=Object.keys(c);for(let t=0;t<e.length;t++)o.hasOwnProperty(e[t])||p.unshift([e[t],S+"remove"])}p.forEach((([t,n])=>{var r;if(null!=(r=e.__r3f)&&r.primitive&&"object"===t)return;if(O.equ(n,c[t]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(t))return d.push([t,n,!0,[]]);let i=[];t.includes("-")&&(i=t.split("-")),d.push([t,n,!1,i]);for(const e in o){const n=o[e];e.startsWith(`${t}-`)&&d.push([e,n,!1,e.split("-")])}}));const v={...o};return f.memoizedProps&&f.memoizedProps.args&&(v.args=f.memoizedProps.args),f.memoizedProps&&f.memoizedProps.attach&&(v.attach=f.memoizedProps.attach),{memoized:v,changes:d}}function L(e,t){var n,o,i;const a=null!=(n=e.__r3f)?n:{},s=a.root,c=null!=(o=null==s||null==s.getState?void 0:s.getState())?o:{},{memoized:l,changes:u}=j(t)?t:F(e,t),f=a.eventCount;e.__r3f&&(e.__r3f.memoizedProps=l);for(let t=0;t<u.length;t++){let[n,o,i,s]=u[t];if(m(e)){const e=3001,t="srgb",r="srgb-linear";"encoding"===n?(n="colorSpace",o=o===e?t:r):"outputEncoding"===n&&(n="outputColorSpace",o=o===e?t:r)}let l=e,f=l[n];if(s.length&&(f=s.reduce(((e,t)=>e[t]),e),!f||!f.set)){const[t,...r]=s.reverse();l=r.reverse().reduce(((e,t)=>e[t]),e),n=t}if(o===S+"remove")if(l.constructor){let e=M.get(l.constructor);e||(e=new l.constructor,M.set(l.constructor,e)),o=e[n]}else o=0;if(i)o?a.handlers[n]=o:delete a.handlers[n],a.eventCount=Object.keys(a.handlers).length;else if(f&&f.set&&(f.copy||f instanceof r.Layers)){if(Array.isArray(o))f.fromArray?f.fromArray(o):f.set(...o);else if(f.copy&&o&&o.constructor&&f.constructor===o.constructor)f.copy(o);else if(void 0!==o){const e=f instanceof r.Color;!e&&f.setScalar?f.setScalar(o):f instanceof r.Layers&&o instanceof r.Layers?f.mask=o.mask:f.set(o),g()||c.linear||!e||f.convertSRGBToLinear()}}else if(l[n]=o,l[n]instanceof r.Texture&&l[n].format===r.RGBAFormat&&l[n].type===r.UnsignedByteType){const e=l[n];m(e)&&m(c.gl)?e.colorSpace=c.gl.outputColorSpace:e.encoding=c.gl.outputEncoding}H(e)}if(a.parent&&c.internal&&e.raycast&&f!==a.eventCount){const t=c.internal.interaction.indexOf(e);t>-1&&c.internal.interaction.splice(t,1),a.eventCount&&c.internal.interaction.push(e)}return!(1===u.length&&"onUpdate"===u[0][0])&&u.length&&null!=(i=e.__r3f)&&i.parent&&q(e),e}function H(e){var t,n;const r=null==(t=e.__r3f)||null==(n=t.root)||null==n.getState?void 0:n.getState();r&&0===r.internal.frames&&r.invalidate()}function q(e){null==e.onUpdate||e.onUpdate(e)}function B(e,t){e.manual||(y(e)?(e.left=t.width/-2,e.right=t.width/2,e.top=t.height/2,e.bottom=t.height/-2):e.aspect=t.width/t.height,e.updateProjectionMatrix(),e.updateMatrixWorld())}function V(e){return(e.eventObject||e.object).uuid+"/"+e.index+e.instanceId}function U(e,t,n,r){const o=n.get(t);o&&(n.delete(t),0===n.size&&(e.delete(r),o.target.releasePointerCapture(r)))}function $(e){function t(e){return e.filter((e=>["Move","Over","Enter","Out","Leave"].some((t=>{var n;return null==(n=e.__r3f)?void 0:n.handlers["onPointer"+t]}))))}function n(t){const{internal:n}=e.getState();for(const e of n.hovered.values())if(!t.length||!t.find((t=>t.object===e.object&&t.index===e.index&&t.instanceId===e.instanceId))){const r=e.eventObject.__r3f,o=null==r?void 0:r.handlers;if(n.hovered.delete(V(e)),null!=r&&r.eventCount){const n={...e,intersections:t};null==o.onPointerOut||o.onPointerOut(n),null==o.onPointerLeave||o.onPointerLeave(n)}}}function o(e,t){for(let n=0;n<t.length;n++){const r=t[n].__r3f;null==r||null==r.handlers.onPointerMissed||r.handlers.onPointerMissed(e)}}return{handlePointer:function(i){switch(i){case"onPointerLeave":case"onPointerCancel":return()=>n([]);case"onLostPointerCapture":return t=>{const{internal:r}=e.getState();"pointerId"in t&&r.capturedMap.has(t.pointerId)&&requestAnimationFrame((()=>{r.capturedMap.has(t.pointerId)&&(r.capturedMap.delete(t.pointerId),n([]))}))}}return function(a){const{onPointerMissed:s,internal:c}=e.getState();c.lastEvent.current=a;const l="onPointerMove"===i,u="onClick"===i||"onContextMenu"===i||"onDoubleClick"===i,f=function(t,n){const r=e.getState(),o=new Set,i=[],a=n?n(r.internal.interaction):r.internal.interaction;for(let e=0;e<a.length;e++){const t=x(a[e]);t&&(t.raycaster.camera=void 0)}r.previousRoot||null==r.events.compute||r.events.compute(t,r);let s=a.flatMap((function(e){const n=x(e);return n&&n.events.enabled&&null!==n.raycaster.camera?(void 0===n.raycaster.camera&&(null==n.events.compute||n.events.compute(t,n,null==(r=n.previousRoot)?void 0:r.getState()),void 0===n.raycaster.camera&&(n.raycaster.camera=null)),n.raycaster.camera?n.raycaster.intersectObject(e,!0):[]):[];var r})).sort(((e,t)=>{const n=x(e.object),r=x(t.object);return n&&r&&r.events.priority-n.events.priority||e.distance-t.distance})).filter((e=>{const t=V(e);return!o.has(t)&&(o.add(t),!0)}));r.events.filter&&(s=r.events.filter(s,r));for(const e of s){let t=e.object;for(;t;){var c;null!=(c=t.__r3f)&&c.eventCount&&i.push({...e,eventObject:t}),t=t.parent}}if("pointerId"in t&&r.internal.capturedMap.has(t.pointerId))for(let e of r.internal.capturedMap.get(t.pointerId).values())o.has(V(e.intersection))||i.push(e.intersection);return i}(a,l?t:void 0),p=u?function(t){const{internal:n}=e.getState(),r=t.offsetX-n.initialClick[0],o=t.offsetY-n.initialClick[1];return Math.round(Math.sqrt(r*r+o*o))}(a):0;"onPointerDown"===i&&(c.initialClick=[a.offsetX,a.offsetY],c.initialHits=f.map((e=>e.eventObject))),u&&!f.length&&p<=2&&(o(a,c.interaction),s&&s(a)),l&&n(f),function(t,o,i,a){const s=e.getState();if(t.length){const e={stopped:!1};for(const c of t){const l=x(c.object)||s,{raycaster:u,pointer:f,camera:p,internal:d}=l,v=new r.Vector3(f.x,f.y,0).unproject(p),h=e=>{var t,n;return null!=(t=null==(n=d.capturedMap.get(e))?void 0:n.has(c.eventObject))&&t},m=e=>{const t={intersection:c,target:o.target};d.capturedMap.has(e)?d.capturedMap.get(e).set(c.eventObject,t):d.capturedMap.set(e,new Map([[c.eventObject,t]])),o.target.setPointerCapture(e)},g=e=>{const t=d.capturedMap.get(e);t&&U(d.capturedMap,c.eventObject,t,e)};let y={};for(let e in o){let t=o[e];"function"!=typeof t&&(y[e]=t)}let b={...c,...y,pointer:f,intersections:t,stopped:e.stopped,delta:i,unprojectedPoint:v,ray:u.ray,camera:p,stopPropagation(){const r="pointerId"in o&&d.capturedMap.get(o.pointerId);(!r||r.has(c.eventObject))&&(b.stopped=e.stopped=!0,d.hovered.size&&Array.from(d.hovered.values()).find((e=>e.eventObject===c.eventObject)))&&n([...t.slice(0,t.indexOf(c)),c])},target:{hasPointerCapture:h,setPointerCapture:m,releasePointerCapture:g},currentTarget:{hasPointerCapture:h,setPointerCapture:m,releasePointerCapture:g},nativeEvent:o};if(a(b),!0===e.stopped)break}}}(f,a,p,(function(e){const t=e.eventObject,n=t.__r3f,r=null==n?void 0:n.handlers;if(null!=n&&n.eventCount)if(l){if(r.onPointerOver||r.onPointerEnter||r.onPointerOut||r.onPointerLeave){const t=V(e),n=c.hovered.get(t);n?n.stopped&&e.stopPropagation():(c.hovered.set(t,e),null==r.onPointerOver||r.onPointerOver(e),null==r.onPointerEnter||r.onPointerEnter(e))}null==r.onPointerMove||r.onPointerMove(e)}else{const n=r[i];n?u&&!c.initialHits.includes(t)||(o(a,c.interaction.filter((e=>!c.initialHits.includes(e)))),n(e)):u&&c.initialHits.includes(t)&&o(a,c.interaction.filter((e=>!c.initialHits.includes(e))))}}))}}}}const W=["set","get","setSize","setFrameloop","setDpr","events","invalidate","advance","size","viewport"],G=e=>!(null==e||!e.render),N=o.createContext(null),Z=(e,t)=>{const n=(0,a.Z)(((n,i)=>{const a=new r.Vector3,s=new r.Vector3,c=new r.Vector3;function l(e=i().camera,t=s,n=i().size){const{width:o,height:l,top:u,left:f}=n,p=o/l;t instanceof r.Vector3?c.copy(t):c.set(...t);const d=e.getWorldPosition(a).distanceTo(c);if(y(e))return{width:o/e.zoom,height:l/e.zoom,top:u,left:f,factor:1,distance:d,aspect:p};{const t=e.fov*Math.PI/180,n=2*Math.tan(t/2)*d,r=n*(o/l);return{width:r,height:n,top:u,left:f,factor:o/r,distance:d,aspect:p}}}let u;const f=e=>n((t=>({performance:{...t.performance,current:e}}))),p=new r.Vector2,d={set:n,get:i,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(t=1)=>e(i(),t),advance:(e,n)=>t(e,n,i()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new r.Clock,pointer:p,mouse:p,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const e=i();u&&clearTimeout(u),e.performance.current!==e.performance.min&&f(e.performance.min),u=setTimeout((()=>f(i().performance.max)),e.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:l},setEvents:e=>n((t=>({...t,events:{...t.events,...e}}))),setSize:(e,t,r,o,a)=>{const c=i().camera,u={width:e,height:t,top:o||0,left:a||0,updateStyle:r};n((e=>({size:u,viewport:{...e.viewport,...l(c,s,u)}})))},setDpr:e=>n((t=>{const n=E(e);return{viewport:{...t.viewport,dpr:n,initialDpr:t.viewport.initialDpr||n}}})),setFrameloop:(e="always")=>{const t=i().clock;t.stop(),t.elapsedTime=0,"never"!==e&&(t.start(),t.elapsedTime=0),n((()=>({frameloop:e})))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:o.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(e,t,n)=>{const r=i().internal;return r.priority=r.priority+(t>0?1:0),r.subscribers.push({ref:e,priority:t,store:n}),r.subscribers=r.subscribers.sort(((e,t)=>e.priority-t.priority)),()=>{const n=i().internal;null!=n&&n.subscribers&&(n.priority=n.priority-(t>0?1:0),n.subscribers=n.subscribers.filter((t=>t.ref!==e)))}}}};return d})),i=n.getState();let s=i.size,c=i.viewport.dpr,l=i.camera;return n.subscribe((()=>{const{camera:e,size:t,viewport:r,gl:o,set:i}=n.getState();if(t!==s||r.dpr!==c){var a;s=t,c=r.dpr,B(e,t),o.setPixelRatio(r.dpr);const n=null!=(a=t.updateStyle)?a:"undefined"!=typeof HTMLCanvasElement&&o.domElement instanceof HTMLCanvasElement;o.setSize(t.width,t.height,n)}e!==l&&(l=e,i((t=>({viewport:{...t.viewport,...t.viewport.getCurrentViewport(e)}}))))})),n.subscribe((t=>e(t))),n};function X(e,t){const n={callback:e};return t.add(n),()=>{t.delete(n)}}let Y,J=new Set,K=new Set,Q=new Set;const ee=e=>X(e,J),te=e=>X(e,K),ne=e=>X(e,Q);function re(e,t){if(e.size)for(const{callback:n}of e.values())n(t)}function oe(e,t){switch(e){case"before":return re(J,t);case"after":return re(K,t);case"tail":return re(Q,t)}}let ie,ae;function se(e,t,n){let r=t.clock.getDelta();for("never"===t.frameloop&&"number"==typeof e&&(r=e-t.clock.elapsedTime,t.clock.oldTime=t.clock.elapsedTime,t.clock.elapsedTime=e),ie=t.internal.subscribers,Y=0;Y<ie.length;Y++)ae=ie[Y],ae.ref.current(ae.store.getState(),r,n);return!t.internal.priority&&t.gl.render&&t.gl.render(t.scene,t.camera),t.internal.frames=Math.max(0,t.internal.frames-1),"always"===t.frameloop?1:t.internal.frames}function ce(e){const t=o.useRef(null);return w((()=>{t.current=e.current.__r3f}),[e]),t}function le(){const e=o.useContext(N);if(!e)throw new Error("R3F: Hooks can only be used within the Canvas component!");return e}function ue(e=(e=>e),t){return le()(e,t)}function fe(e,t=0){const n=le(),r=n.getState().internal.subscribe,o=_(e);return w((()=>r(o,t,n)),[t,r,n]),null}function pe(e){return o.useMemo((()=>k(e)),[e])}const de=new WeakMap;function ve(e,t){return function(n,...r){let o=de.get(n);return o||(o=new n,de.set(n,o)),e&&e(o),Promise.all(r.map((e=>new Promise(((n,r)=>o.load(e,(e=>{e.scene&&Object.assign(e,k(e.scene)),n(e)}),t,(t=>r(new Error(`Could not load ${e}: ${null==t?void 0:t.message}`))))))))).finally((()=>null==o.dispose?void 0:o.dispose()))}}function he(e,t,n,r){const o=Array.isArray(t)?t:[t],i=(0,u.Rq)(ve(n,r),[e,...o],{equal:O.equ});return Array.isArray(t)?i:i[0]}he.preload=function(e,t,n){const r=Array.isArray(t)?t:[t];return(0,u.MA)(ve(n),[e,...r])},he.clear=function(e,t){const n=Array.isArray(t)?t:[t];return(0,u.ZH)([e,...n])};const me=new Map,{invalidate:ge,advance:ye}=function(e){let t,n,r,o=!1;function i(a){n=requestAnimationFrame(i),o=!0,t=0,oe("before",a);for(const n of e.values()){var s;r=n.store.getState(),!r.internal.active||!("always"===r.frameloop||r.internal.frames>0)||null!=(s=r.gl.xr)&&s.isPresenting||(t+=se(a,r))}if(oe("after",a),0===t)return oe("tail",a),o=!1,cancelAnimationFrame(n)}return{loop:i,invalidate:function t(n,r=1){var a;if(!n)return e.forEach((e=>t(e.store.getState())),r);null!=(a=n.gl.xr)&&a.isPresenting||!n.internal.active||"never"===n.frameloop||(n.internal.frames=Math.min(60,n.internal.frames+r),o||(o=!0,requestAnimationFrame(i)))},advance:function(t,n=!0,r,o){if(n&&oe("before",t),r)se(t,r,o);else for(const n of e.values())se(t,n.store.getState());n&&oe("after",t)}}}(me),{reconciler:be,applyProps:we}=function(e,t){function n(e,{args:t=[],attach:n,...o},i){let a,s=`${e[0].toUpperCase()}${e.slice(1)}`;if("primitive"===e){if(void 0===o.object)throw new Error("R3F: Primitives without 'object' are invalid!");a=z(o.object,{type:e,root:i,attach:n,primitive:!0})}else{const r=p[s];if(!r)throw new Error(`R3F: ${s} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(t))throw new Error("R3F: The args prop must be an array!");a=z(new r(...t),{type:e,root:i,attach:n,memoizedProps:{args:t}})}return void 0===a.__r3f.attach&&(a instanceof r.BufferGeometry?a.__r3f.attach="geometry":a instanceof r.Material&&(a.__r3f.attach="material")),"inject"!==s&&L(a,o),a}function o(e,t){let n=!1;var r,o;t&&(null!=(r=t.__r3f)&&r.attach?D(e,t,t.__r3f.attach):t.isObject3D&&e.isObject3D&&(e.add(t),n=!0),n||null==(o=e.__r3f)||o.objects.push(t),t.__r3f||z(t,{}),t.__r3f.parent=e,q(t),H(t))}function a(e,t,n){let r=!1;if(t){var o,i;if(null!=(o=t.__r3f)&&o.attach)D(e,t,t.__r3f.attach);else if(t.isObject3D&&e.isObject3D){t.parent=e,t.dispatchEvent({type:"added"});const o=e.children.filter((e=>e!==t)),i=o.indexOf(n);e.children=[...o.slice(0,i),t,...o.slice(i)],r=!0}r||null==(i=e.__r3f)||i.objects.push(t),t.__r3f||z(t,{}),t.__r3f.parent=e,q(t),H(t)}}function s(e,t,n=!1){e&&[...e].forEach((e=>u(t,e,n)))}function u(e,t,n){if(t){var r,o,i;if(t.__r3f&&(t.__r3f.parent=null),null!=(r=e.__r3f)&&r.objects&&(e.__r3f.objects=e.__r3f.objects.filter((e=>e!==t))),null!=(o=t.__r3f)&&o.attach)I(e,t,t.__r3f.attach);else if(t.isObject3D&&e.isObject3D){var a;e.remove(t),null!=(a=t.__r3f)&&a.root&&function(e,t){const{internal:n}=e.getState();n.interaction=n.interaction.filter((e=>e!==t)),n.initialHits=n.initialHits.filter((e=>e!==t)),n.hovered.forEach(((e,r)=>{e.eventObject!==t&&e.object!==t||n.hovered.delete(r)})),n.capturedMap.forEach(((e,r)=>{U(n.capturedMap,t,e,r)}))}(t.__r3f.root,t)}const u=null==(i=t.__r3f)?void 0:i.primitive,f=void 0===n?null!==t.dispose&&!u:n;var c;if(!u)s(null==(c=t.__r3f)?void 0:c.objects,t,f),s(t.children,t,f);delete t.__r3f,f&&t.dispose&&"Scene"!==t.type&&(0,l.unstable_scheduleCallback)(l.unstable_IdlePriority,(()=>{try{t.dispose()}catch(e){}})),H(e)}}const f=()=>console.warn("Text is not allowed in the R3F tree! This could be stray whitespace or characters.");return{reconciler:c()({createInstance:n,removeChild:u,appendChild:o,appendInitialChild:o,insertBefore:a,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(e,t)=>{if(!t)return;const n=e.getState().scene;n.__r3f&&(n.__r3f.root=e,o(n,t))},removeChildFromContainer:(e,t)=>{t&&u(e.getState().scene,t)},insertInContainerBefore:(e,t,n)=>{if(!t||!n)return;const r=e.getState().scene;r.__r3f&&a(r,t,n)},getRootHostContext:()=>null,getChildHostContext:e=>e,finalizeInitialChildren(e){var t;const n=null!=(t=null==e?void 0:e.__r3f)?t:{};return Boolean(n.handlers)},prepareUpdate(e,t,n,r){var o;if((null!=(o=null==e?void 0:e.__r3f)?o:{}).primitive&&r.object&&r.object!==e)return[!0];{const{args:t=[],children:o,...i}=r,{args:a=[],children:s,...c}=n;if(!Array.isArray(t))throw new Error("R3F: the args prop must be an array!");if(t.some(((e,t)=>e!==a[t])))return[!0];const l=F(e,i,c,!0);return l.changes.length?[!1,l]:null}},commitUpdate(e,[t,r],i,a,s,c){t?function(e,t,r,i){var a;const s=null==(a=e.__r3f)?void 0:a.parent;if(!s)return;const c=n(t,r,e.__r3f.root);if(e.children){for(const t of e.children)t.__r3f&&o(c,t);e.children=e.children.filter((e=>!e.__r3f))}e.__r3f.objects.forEach((e=>o(c,e))),e.__r3f.objects=[],e.__r3f.autoRemovedBeforeAppend||u(s,e),c.parent&&(c.__r3f.autoRemovedBeforeAppend=!0),o(s,c),c.raycast&&c.__r3f.eventCount&&c.__r3f.root.getState().internal.interaction.push(c);[i,i.alternate].forEach((e=>{null!==e&&(e.stateNode=c,e.ref&&("function"==typeof e.ref?e.ref(c):e.ref.current=c))}))}(e,i,s,c):L(e,r)},commitMount(e,t,n,r){var o;const i=null!=(o=e.__r3f)?o:{};e.raycast&&i.handlers&&i.eventCount&&e.__r3f.root.getState().internal.interaction.push(e)},getPublicInstance:e=>e,prepareForCommit:()=>null,preparePortalMount:e=>z(e.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(e){var t;const{attach:n,parent:r}=null!=(t=e.__r3f)?t:{};n&&r&&I(r,e,n),e.isObject3D&&(e.visible=!1),H(e)},unhideInstance(e,t){var n;const{attach:r,parent:o}=null!=(n=e.__r3f)?n:{};r&&o&&D(o,e,r),(e.isObject3D&&null==t.visible||t.visible)&&(e.visible=!0),H(e)},createTextInstance:f,hideTextInstance:f,unhideTextInstance:f,getCurrentEventPriority:()=>t?t():i.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:"undefined"!=typeof performance&&O.fun(performance.now)?performance.now:O.fun(Date.now)?Date.now:()=>0,scheduleTimeout:O.fun(setTimeout)?setTimeout:void 0,cancelTimeout:O.fun(clearTimeout)?clearTimeout:void 0}),applyProps:L}}(0,(function(){var e;const t="undefined"!=typeof self&&self||"undefined"!=typeof window&&window;if(!t)return i.DefaultEventPriority;switch(null==(e=t.event)?void 0:e.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return i.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return i.ContinuousEventPriority;default:return i.DefaultEventPriority}})),_e={objects:"shallow",strict:!1},Ce=(e,t)=>{const n="function"==typeof e?e(t):e;return G(n)?n:new r.WebGLRenderer({powerPreference:"high-performance",canvas:t,antialias:!0,alpha:!0,...e})};function Pe(e){const t=me.get(e),n=null==t?void 0:t.fiber,a=null==t?void 0:t.store;t&&console.warn("R3F.createRoot should only be called once!");const s="function"==typeof reportError?reportError:console.error,c=a||Z(ge,ye),l=n||be.createContainer(c,i.ConcurrentRoot,null,!1,null,"",s,null);let u;t||me.set(e,{fiber:l,store:c});let f,p=!1;return{configure(t={}){let{gl:n,size:o,scene:i,events:a,onCreated:s,shadows:l=!1,linear:d=!1,flat:v=!1,legacy:h=!1,orthographic:m=!1,frameloop:y="always",dpr:b=[1,2],performance:w,raycaster:_,camera:C,onPointerMissed:P}=t,S=c.getState(),M=S.gl;S.gl||S.set({gl:M=Ce(n,e)});let j=S.raycaster;j||S.set({raycaster:j=new r.Raycaster});const{params:x,...k}=_||{};if(O.equ(k,j,_e)||we(j,{...k}),O.equ(x,j.params,_e)||we(j,{params:{...j.params,...x}}),!S.camera||S.camera===f&&!O.equ(f,C,_e)){f=C;const e=C instanceof r.Camera,t=e?C:m?new r.OrthographicCamera(0,0,0,0,.1,1e3):new r.PerspectiveCamera(75,0,.1,1e3);e||(t.position.z=5,C&&we(t,C),S.camera||null!=C&&C.rotation||t.lookAt(0,0,0)),S.set({camera:t})}if(!S.scene){let e;i instanceof r.Scene?e=i:(e=new r.Scene,i&&we(e,i)),S.set({scene:z(e)})}if(!S.xr){var A;const e=(e,t)=>{const n=c.getState();"never"!==n.frameloop&&ye(e,!0,n,t)},t=()=>{const t=c.getState();t.gl.xr.enabled=t.gl.xr.isPresenting,t.gl.xr.setAnimationLoop(t.gl.xr.isPresenting?e:null),t.gl.xr.isPresenting||ge(t)},n={connect(){const e=c.getState().gl;e.xr.addEventListener("sessionstart",t),e.xr.addEventListener("sessionend",t)},disconnect(){const e=c.getState().gl;e.xr.removeEventListener("sessionstart",t),e.xr.removeEventListener("sessionend",t)}};"function"==typeof(null==(A=M.xr)?void 0:A.addEventListener)&&n.connect(),S.set({xr:n})}if(M.shadowMap){const e=M.shadowMap.enabled,t=M.shadowMap.type;if(M.shadowMap.enabled=!!l,O.boo(l))M.shadowMap.type=r.PCFSoftShadowMap;else if(O.str(l)){var T;const e={basic:r.BasicShadowMap,percentage:r.PCFShadowMap,soft:r.PCFSoftShadowMap,variance:r.VSMShadowMap};M.shadowMap.type=null!=(T=e[l])?T:r.PCFSoftShadowMap}else O.obj(l)&&Object.assign(M.shadowMap,l);e===M.shadowMap.enabled&&t===M.shadowMap.type||(M.shadowMap.needsUpdate=!0)}const R=g();R&&("enabled"in R?R.enabled=!h:"legacyMode"in R&&(R.legacyMode=h));we(M,{outputEncoding:d?3e3:3001,toneMapping:v?r.NoToneMapping:r.ACESFilmicToneMapping}),S.legacy!==h&&S.set((()=>({legacy:h}))),S.linear!==d&&S.set((()=>({linear:d}))),S.flat!==v&&S.set((()=>({flat:v}))),!n||O.fun(n)||G(n)||O.equ(n,M,_e)||we(M,n),a&&!S.events.handlers&&S.set({events:a(c)});const D=function(e,t){if(t)return t;if("undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement&&e.parentElement){const{width:t,height:n,top:r,left:o}=e.parentElement.getBoundingClientRect();return{width:t,height:n,top:r,left:o}}return"undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas?{width:e.width,height:e.height,top:0,left:0}:{width:0,height:0,top:0,left:0}}(e,o);return O.equ(D,S.size,_e)||S.setSize(D.width,D.height,D.updateStyle,D.top,D.left),b&&S.viewport.dpr!==E(b)&&S.setDpr(b),S.frameloop!==y&&S.setFrameloop(y),S.onPointerMissed||S.set({onPointerMissed:P}),w&&!O.equ(w,S.performance,_e)&&S.set((e=>({performance:{...e.performance,...w}}))),u=s,p=!0,this},render(t){return p||this.configure(),be.updateContainer(o.createElement(Me,{store:c,children:t,onCreated:u,rootElement:e}),l,null,(()=>{})),c},unmount(){je(e)}}}function Se(e,t,n){console.warn("R3F.render is no longer supported in React 18. Use createRoot instead!");const r=Pe(t);return r.configure(n),r.render(e)}function Me({store:e,children:t,onCreated:n,rootElement:r}){return w((()=>{const t=e.getState();t.set((e=>({internal:{...e.internal,active:!0}}))),n&&n(t),e.getState().events.connected||null==t.events.connect||t.events.connect(r)}),[]),o.createElement(N.Provider,{value:e},t)}function je(e,t){const n=me.get(e),r=null==n?void 0:n.fiber;if(r){const o=null==n?void 0:n.store.getState();o&&(o.internal.active=!1),be.updateContainer(null,r,null,(()=>{o&&setTimeout((()=>{try{var n,r,i,a;null==o.events.disconnect||o.events.disconnect(),null==(n=o.gl)||null==(r=n.renderLists)||null==r.dispose||r.dispose(),null==(i=o.gl)||null==i.forceContextLoss||i.forceContextLoss(),null!=(a=o.gl)&&a.xr&&o.xr.disconnect(),A(o),me.delete(e),t&&t(e)}catch(e){}}),500)}))}}function Ee(e,t,n){return o.createElement(xe,{key:t.uuid,children:e,container:t,state:n})}function xe({state:e={},children:t,container:n}){const{events:i,size:s,...c}=e,l=le(),[u]=o.useState((()=>new r.Raycaster)),[f]=o.useState((()=>new r.Vector2)),p=o.useCallback(((e,t)=>{const o={...e};let a;if(Object.keys(e).forEach((n=>{(W.includes(n)||e[n]!==t[n]&&t[n])&&delete o[n]})),t&&s){const n=t.camera;a=e.viewport.getCurrentViewport(n,new r.Vector3,s),n!==e.camera&&B(n,s)}return{...o,scene:n,raycaster:u,pointer:f,mouse:f,previousRoot:l,events:{...e.events,...null==t?void 0:t.events,...i},size:{...e.size,...s},viewport:{...e.viewport,...a},...c}}),[e]),[d]=o.useState((()=>{const e=l.getState(),t=(0,a.Z)(((t,r)=>({...e,scene:n,raycaster:u,pointer:f,mouse:f,previousRoot:l,events:{...e.events,...i},size:{...e.size,...s},...c,set:t,get:r,setEvents:e=>t((t=>({...t,events:{...t.events,...e}})))})));return t}));return o.useEffect((()=>{const e=l.subscribe((e=>d.setState((t=>p(e,t)))));return()=>{e(),d.destroy()}}),[]),o.useEffect((()=>{d.setState((e=>p(l.getState(),e)))}),[p]),o.createElement(o.Fragment,null,be.createPortal(o.createElement(N.Provider,{value:d},t),d,null))}be.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:o.version});const Oe=o.unstable_act}}]);