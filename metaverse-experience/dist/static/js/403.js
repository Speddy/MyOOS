(self.webpackChunkmetaverse_experience=self.webpackChunkmetaverse_experience||[]).push([[403],{1416:t=>{t.exports=function(){function t(t,e){return 0===e.length||-1!==e.indexOf(t.detail.buttonEvent.type)}return{schema:{startButtons:{default:[]},endButtons:{default:[]}},startButtonOk:function(e){return t(e,this.data.startButtons)},endButtonOk:function(e){return t(e,this.data.endButtons)}}}()},2945:t=>{t.exports={schema:{usePhysics:{default:"ifavailable"}},physicsInit:function(){this.constraints=new Map},physicsUpdate:function(){"never"===this.data.usePhysics&&this.constraints.size&&this.physicsClear()},physicsRemove:function(){this.physicsClear()},physicsStart:function(t){if("never"!==this.data.usePhysics&&this.el.body&&t.detail.hand.body&&!this.constraints.has(t.detail.hand)){const e=Math.random().toString(36).substr(2,9);return this.el.setAttribute("constraint__"+e,{target:t.detail.hand}),this.constraints.set(t.detail.hand,e),!0}return"only"===this.data.usePhysics},physicsEnd:function(t){const e=this.constraints.get(t.detail.hand);e&&(this.el.removeAttribute("constraint__"+e),this.constraints.delete(t.detail.hand))},physicsClear:function(){if(this.el.body)for(const t of this.constraints.values())this.el.body.world.removeConstraint(t);this.constraints.clear()},physicsIsConstrained:function(t){return this.constraints.has(t)},physicsIsGrabbing(){return this.constraints.size>0}}},4336:(t,e,s)=>{const r=AFRAME.utils.extendDeep,n=r({},s(1416));AFRAME.registerComponent("stretchable",r(n,{schema:{usePhysics:{default:"ifavailable"},invert:{default:!1},physicsUpdateRate:{default:100}},init:function(){this.STRETCHED_STATE="stretched",this.STRETCH_EVENT="stretch-start",this.UNSTRETCH_EVENT="stretch-end",this.stretched=!1,this.stretchers=[],this.scale=new THREE.Vector3,this.handPos=new THREE.Vector3,this.otherHandPos=new THREE.Vector3,this.start=this.start.bind(this),this.end=this.end.bind(this),this.el.addEventListener(this.STRETCH_EVENT,this.start),this.el.addEventListener(this.UNSTRETCH_EVENT,this.end)},update:function(t){this.updateBodies=AFRAME.utils.throttleTick(this._updateBodies,this.data.physicsUpdateRate,this)},tick:function(t,e){if(!this.stretched)return;this.scale.copy(this.el.getAttribute("scale")),this.stretchers[0].object3D.getWorldPosition(this.handPos),this.stretchers[1].object3D.getWorldPosition(this.otherHandPos);const s=this.handPos.distanceTo(this.otherHandPos);let r=1;null!==this.previousStretch&&0!==s&&(r=Math.pow(s/this.previousStretch,this.data.invert?-1:1)),this.previousStretch=s,null==this.previousPhysicsStretch&&(this.previousPhysicsStretch=s),this.scale.multiplyScalar(r),this.el.setAttribute("scale",this.scale),this.updateBodies(t,e)},remove:function(){this.el.removeEventListener(this.STRETCH_EVENT,this.start),this.el.removeEventListener(this.UNSTRETCH_EVENT,this.end)},start:function(t){this.stretched||this.stretchers.includes(t.detail.hand)||!this.startButtonOk(t)||t.defaultPrevented||(this.stretchers.push(t.detail.hand),2===this.stretchers.length&&(this.stretched=!0,this.previousStretch=null,this.previousPhysicsStretch=null,this.el.addState(this.STRETCHED_STATE)),t.preventDefault&&t.preventDefault())},end:function(t){const e=this.stretchers.indexOf(t.detail.hand);!t.defaultPrevented&&this.endButtonOk(t)&&(-1!==e&&(this.stretchers.splice(e,1),this.stretched=!1,this.el.removeState(this.STRETCHED_STATE),this._updateBodies()),t.preventDefault&&t.preventDefault())},_updateBodies:function(){if(!this.el.body||"never"===this.data.usePhysics)return;const t=this.previousStretch;let e=1;if(null!==this.previousPhysicsStretch&&t>0&&(e=Math.pow(t/this.previousPhysicsStretch,this.data.invert?-1:1)),this.previousPhysicsStretch=t,1!==e){for(const t of this.el.childNodes)this.stretchBody(t,e);this.stretchBody(this.el,e)}},stretchBody:function(t,e){if(!t.body)return;let s,r;for(let n=0;n<t.body.shapes.length;n++)s=t.body.shapes[n],s.halfExtents?(s.halfExtents.scale(e,s.halfExtents),s.updateConvexPolyhedronRepresentation()):s.radius?(s.radius*=e,s.updateBoundingSphereRadius()):this.shapeWarned||(console.warn("Unable to stretch physics body: unsupported shape"),this.shapeWarned=!0),r=t.body.shapeOffsets[n],r.scale(e,r);t.body.updateBoundingRadius()}}))},2040:()=>{AFRAME.registerSystem("super-hands",{init:function(){this.superHands=[]},registerMe:function(t){1===this.superHands.length&&(this.superHands[0].otherSuperHand=t,t.otherSuperHand=this.superHands[0]),this.superHands.push(t)},unregisterMe:function(t){const e=this.superHands.indexOf(t);-1!==e&&this.superHands.splice(e,1),this.superHands.forEach((e=>{e.otherSuperHand===t&&(e.otherSuperHand=null)}))}})},6594:(t,e,s)=>{"use strict";s.r(e),s.d(e,{Pathfinding:()=>h,PathfindingHelper:()=>c});var r=s(9477);class n{static roundNumber(t,e){const s=Math.pow(10,e);return Math.round(t*s)/s}static sample(t){return t[Math.floor(Math.random()*t.length)]}static distanceToSquared(t,e){var s=t.x-e.x,r=t.y-e.y,n=t.z-e.z;return s*s+r*r+n*n}static isPointInPoly(t,e){for(var s=!1,r=-1,n=t.length,i=n-1;++r<n;i=r)(t[r].z<=e.z&&e.z<t[i].z||t[i].z<=e.z&&e.z<t[r].z)&&e.x<(t[i].x-t[r].x)*(e.z-t[r].z)/(t[i].z-t[r].z)+t[r].x&&(s=!s);return s}static isVectorInPolygon(t,e,s){var r=1e5,n=-1e5,i=[];return e.vertexIds.forEach((t=>{r=Math.min(s[t].y,r),n=Math.max(s[t].y,n),i.push(s[t])})),!!(t.y<n+.5&&t.y>r-.5&&this.isPointInPoly(i,t))}static triarea2(t,e,s){return(s.x-t.x)*(e.z-t.z)-(e.x-t.x)*(s.z-t.z)}static vequal(t,e){return this.distanceToSquared(t,e)<1e-5}static mergeVertices(t,e=1e-4){e=Math.max(e,Number.EPSILON);for(var s={},n=t.getIndex(),i=t.getAttribute("position"),o=n?n.count:i.count,h=0,a=[],c=[],u=Math.log10(1/e),l=Math.pow(10,u),d=0;d<o;d++){var p=n?n.getX(d):d,f="";f+=~~(i.getX(p)*l)+",",f+=~~(i.getY(p)*l)+",",(f+=~~(i.getZ(p)*l)+",")in s?a.push(s[f]):(c.push(i.getX(p)),c.push(i.getY(p)),c.push(i.getZ(p)),s[f]=h,a.push(h),h++)}const g=new r.TlE(new Float32Array(c),i.itemSize,i.normalized),v=new r.u9r;return v.setAttribute("position",g),v.setIndex(a),v}}class i{constructor(t){this.content=[],this.scoreFunction=t}push(t){this.content.push(t),this.sinkDown(this.content.length-1)}pop(){const t=this.content[0],e=this.content.pop();return this.content.length>0&&(this.content[0]=e,this.bubbleUp(0)),t}remove(t){const e=this.content.indexOf(t),s=this.content.pop();e!==this.content.length-1&&(this.content[e]=s,this.scoreFunction(s)<this.scoreFunction(t)?this.sinkDown(e):this.bubbleUp(e))}size(){return this.content.length}rescoreElement(t){this.sinkDown(this.content.indexOf(t))}sinkDown(t){const e=this.content[t];for(;t>0;){const s=(t+1>>1)-1,r=this.content[s];if(!(this.scoreFunction(e)<this.scoreFunction(r)))break;this.content[s]=e,this.content[t]=r,t=s}}bubbleUp(t){const e=this.content.length,s=this.content[t],r=this.scoreFunction(s);for(;;){const n=t+1<<1,i=n-1;let o,h=null;if(i<e&&(o=this.scoreFunction(this.content[i]),o<r&&(h=i)),n<e&&this.scoreFunction(this.content[n])<(null===h?r:o)&&(h=n),null===h)break;this.content[t]=this.content[h],this.content[h]=s,t=h}}}class o{constructor(){this.portals=[]}push(t,e){void 0===e&&(e=t),this.portals.push({left:t,right:e})}stringPull(){const t=this.portals,e=[];let s,r,i,o=0,h=0,a=0;s=t[0].left,r=t[0].left,i=t[0].right,e.push(s);for(let c=1;c<t.length;c++){const u=t[c].left,l=t[c].right;if(n.triarea2(s,i,l)<=0){if(!(n.vequal(s,i)||n.triarea2(s,r,l)>0)){e.push(r),s=r,o=h,r=s,i=s,h=o,a=o,c=o;continue}i=l,a=c}if(n.triarea2(s,r,u)>=0){if(!(n.vequal(s,r)||n.triarea2(s,i,u)<0)){e.push(i),s=i,o=a,r=s,i=s,h=o,a=o,c=o;continue}r=u,h=c}}return 0!==e.length&&n.vequal(e[e.length-1],t[t.length-1].left)||e.push(t[t.length-1].left),this.path=e,e}}class h{constructor(){this.zones={}}static createZone(t,e=1e-4){return class{static buildZone(t,e){const s=this._buildNavigationMesh(t,e),i={};s.vertices.forEach((t=>{t.x=n.roundNumber(t.x,2),t.y=n.roundNumber(t.y,2),t.z=n.roundNumber(t.z,2)})),i.vertices=s.vertices;const o=this._buildPolygonGroups(s);return i.groups=new Array(o.length),o.forEach(((t,e)=>{const s=new Map;t.forEach(((t,e)=>{s.set(t,e)}));const o=new Array(t.length);t.forEach(((t,e)=>{const h=[];t.neighbours.forEach((t=>h.push(s.get(t))));const a=[];t.neighbours.forEach((e=>a.push(this._getSharedVerticesInOrder(t,e))));const c=new r.Pa4(0,0,0);c.add(i.vertices[t.vertexIds[0]]),c.add(i.vertices[t.vertexIds[1]]),c.add(i.vertices[t.vertexIds[2]]),c.divideScalar(3),c.x=n.roundNumber(c.x,2),c.y=n.roundNumber(c.y,2),c.z=n.roundNumber(c.z,2),o[e]={id:e,neighbours:h,vertexIds:t.vertexIds,centroid:c,portals:a}})),i.groups[e]=o})),i}static _buildNavigationMesh(t,e){return t=n.mergeVertices(t,e),this._buildPolygonsFromGeometry(t)}static _spreadGroupId(t){let e=new Set([t]);for(;e.size>0;){const s=e;e=new Set,s.forEach((s=>{s.group=t.group,s.neighbours.forEach((t=>{void 0===t.group&&e.add(t)}))}))}}static _buildPolygonGroups(t){const e=[];return t.polygons.forEach((t=>{void 0!==t.group?e[t.group].push(t):(t.group=e.length,this._spreadGroupId(t),e.push([t]))})),e}static _buildPolygonNeighbours(t,e){const s=new Set,r=e[t.vertexIds[1]],n=e[t.vertexIds[2]];return e[t.vertexIds[0]].forEach((e=>{e!==t&&(r.includes(e)||n.includes(e))&&s.add(e)})),r.forEach((e=>{e!==t&&n.includes(e)&&s.add(e)})),s}static _buildPolygonsFromGeometry(t){const e=[],s=[],n=t.attributes.position,i=t.index,o=[];for(let t=0;t<n.count;t++)s.push((new r.Pa4).fromBufferAttribute(n,t)),o[t]=[];for(let s=0;s<t.index.count;s+=3){const t=i.getX(s),r=i.getX(s+1),n=i.getX(s+2),h={vertexIds:[t,r,n],neighbours:null};e.push(h),o[t].push(h),o[r].push(h),o[n].push(h)}return e.forEach((t=>{t.neighbours=this._buildPolygonNeighbours(t,o)})),{polygons:e,vertices:s}}static _getSharedVerticesInOrder(t,e){const s=t.vertexIds,r=s[0],n=s[1],i=s[2],o=e.vertexIds,h=o.includes(r),a=o.includes(n),c=o.includes(i);return h&&a&&c?Array.from(s):h&&a?[r,n]:a&&c?[n,i]:h&&c?[i,r]:(console.warn("Error processing navigation mesh neighbors; neighbors with <2 shared vertices found."),[])}}.buildZone(t,e)}setZoneData(t,e){this.zones[t]=e}getRandomNode(t,e,s,i){if(!this.zones[t])return new r.Pa4;s=s||null,i=i||0;const o=[];return this.zones[t].groups[e].forEach((t=>{s&&i?n.distanceToSquared(s,t.centroid)<i*i&&o.push(t.centroid):o.push(t.centroid)})),n.sample(o)||new r.Pa4}getClosestNode(t,e,s,r=!1){const i=this.zones[e].vertices;let o=null,h=1/0;return this.zones[e].groups[s].forEach((e=>{const s=n.distanceToSquared(e.centroid,t);s<h&&(!r||n.isVectorInPolygon(t,e,i))&&(o=e,h=s)})),o}findPath(t,e,s,h){const a=this.zones[s].groups[h],c=this.zones[s].vertices,u=this.getClosestNode(t,s,h,!0),l=this.getClosestNode(e,s,h,!0);if(!u||!l)return null;const d=class{static init(t){for(let e=0;e<t.length;e++){const s=t[e];s.f=0,s.g=0,s.h=0,s.cost=1,s.visited=!1,s.closed=!1,s.parent=null}}static cleanUp(t){for(let e=0;e<t.length;e++){const s=t[e];delete s.f,delete s.g,delete s.h,delete s.cost,delete s.visited,delete s.closed,delete s.parent}}static heap(){return new i((function(t){return t.f}))}static search(t,e,s){this.init(t);const r=this.heap();for(r.push(e);r.size()>0;){const e=r.pop();if(e===s){let t=e;const s=[];for(;t.parent;)s.push(t),t=t.parent;return this.cleanUp(s),s.reverse()}e.closed=!0;const n=this.neighbours(t,e);for(let t=0,i=n.length;t<i;t++){const i=n[t];if(i.closed)continue;const o=e.g+i.cost,h=i.visited;if(!h||o<i.g){if(i.visited=!0,i.parent=e,!i.centroid||!s.centroid)throw new Error("Unexpected state");i.h=i.h||this.heuristic(i.centroid,s.centroid),i.g=o,i.f=i.g+i.h,h?r.rescoreElement(i):r.push(i)}}}return[]}static heuristic(t,e){return n.distanceToSquared(t,e)}static neighbours(t,e){const s=[];for(let r=0;r<e.neighbours.length;r++)s.push(t[e.neighbours[r]]);return s}}.search(a,u,l),p=function(t,e){for(var s=0;s<t.neighbours.length;s++)if(t.neighbours[s]===e.id)return t.portals[s]},f=new o;f.push(t);for(let t=0;t<d.length;t++){const e=d[t],s=d[t+1];if(s){const t=p(e,s);f.push(c[t[0]],c[t[1]])}}f.push(e),f.stringPull();const g=f.path.map((t=>new r.Pa4(t.x,t.y,t.z)));return g.shift(),g}}h.prototype.getGroup=function(){const t=new r.JOQ;return function(e,s,r=!1){if(!this.zones[e])return null;let i=null,o=Math.pow(50,2);const h=this.zones[e];for(let e=0;e<h.groups.length;e++){const a=h.groups[e];for(const c of a){if(r&&(t.setFromCoplanarPoints(h.vertices[c.vertexIds[0]],h.vertices[c.vertexIds[1]],h.vertices[c.vertexIds[2]]),Math.abs(t.distanceToPoint(s))<.01)&&n.isPointInPoly([h.vertices[c.vertexIds[0]],h.vertices[c.vertexIds[1]],h.vertices[c.vertexIds[2]]],s))return e;const a=n.distanceToSquared(c.centroid,s);a<o&&(i=e,o=a)}}return i}}(),h.prototype.clampStep=function(){const t=new r.Pa4,e=new r.JOQ,s=new r.CJI,n=new r.Pa4;let i,o,h=new r.Pa4;return function(r,a,c,u,l,d){const p=this.zones[u].vertices,f=this.zones[u].groups[l],g=[c],v={};v[c.id]=0,i=void 0,h.set(0,0,0),o=1/0,e.setFromCoplanarPoints(p[c.vertexIds[0]],p[c.vertexIds[1]],p[c.vertexIds[2]]),e.projectPoint(a,t),n.copy(t);for(let e=g.pop();e;e=g.pop()){s.set(p[e.vertexIds[0]],p[e.vertexIds[1]],p[e.vertexIds[2]]),s.closestPointToPoint(n,t),t.distanceToSquared(n)<o&&(i=e,h.copy(t),o=t.distanceToSquared(n));const r=v[e.id];if(!(r>2))for(let t=0;t<e.neighbours.length;t++){const s=f[e.neighbours[t]];s.id in v||(g.push(s),v[s.id]=r+1)}}return d.copy(h),i}}();const a={PLAYER:new r.Ilk(15631215).convertSRGBToLinear().getHex(),TARGET:new r.Ilk(14469912).convertSRGBToLinear().getHex(),PATH:new r.Ilk(41903).convertSRGBToLinear().getHex(),WAYPOINT:new r.Ilk(41903).convertSRGBToLinear().getHex(),CLAMPED_STEP:new r.Ilk(14472114).convertSRGBToLinear().getHex(),CLOSEST_NODE:new r.Ilk(4417387).convertSRGBToLinear().getHex()};class c extends r.Tme{constructor(){super(),this._playerMarker=new r.Kj0(new r.xo$(.25,32,32),new r.vBJ({color:a.PLAYER})),this._targetMarker=new r.Kj0(new r.DvJ(.3,.3,.3),new r.vBJ({color:a.TARGET})),this._nodeMarker=new r.Kj0(new r.DvJ(.1,.8,.1),new r.vBJ({color:a.CLOSEST_NODE})),this._stepMarker=new r.Kj0(new r.DvJ(.1,1,.1),new r.vBJ({color:a.CLAMPED_STEP})),this._pathMarker=new r.Tme,this._pathLineMaterial=new r.nls({color:a.PATH,linewidth:2}),this._pathPointMaterial=new r.vBJ({color:a.WAYPOINT}),this._pathPointGeometry=new r.xo$(.08),this._markers=[this._playerMarker,this._targetMarker,this._nodeMarker,this._stepMarker,this._pathMarker],this._markers.forEach((t=>{t.visible=!1,this.add(t)}))}setPath(t){for(;this._pathMarker.children.length;)this._pathMarker.children[0].visible=!1,this._pathMarker.remove(this._pathMarker.children[0]);t=[this._playerMarker.position].concat(t);const e=new r.u9r;e.setAttribute("position",new r.TlE(new Float32Array(3*t.length),3));for(let s=0;s<t.length;s++)e.attributes.position.setXYZ(s,t[s].x,t[s].y+.2,t[s].z);this._pathMarker.add(new r.x12(e,this._pathLineMaterial));for(let e=0;e<t.length-1;e++){const s=new r.Kj0(this._pathPointGeometry,this._pathPointMaterial);s.position.copy(t[e]),s.position.y+=.2,this._pathMarker.add(s)}return this._pathMarker.visible=!0,this}setPlayerPosition(t){return this._playerMarker.position.copy(t),this._playerMarker.visible=!0,this}setTargetPosition(t){return this._targetMarker.position.copy(t),this._targetMarker.visible=!0,this}setNodePosition(t){return this._nodeMarker.position.copy(t),this._nodeMarker.visible=!0,this}setStepPosition(t){return this._stepMarker.position.copy(t),this._stepMarker.visible=!0,this}reset(){for(;this._pathMarker.children.length;)this._pathMarker.children[0].visible=!1,this._pathMarker.remove(this._pathMarker.children[0]);return this._markers.forEach((t=>{t.visible=!1})),this}}},8034:t=>{var e=arguments[3],s=arguments[4],r=arguments[5],n=JSON.stringify;t.exports=function(t,i){for(var o,h=Object.keys(r),a=0,c=h.length;a<c;a++){var u=h[a],l=r[u].exports;if(l===t||l&&l.default===t){o=u;break}}if(!o){o=Math.floor(Math.pow(16,8)*Math.random()).toString(16);var d={};for(a=0,c=h.length;a<c;a++){d[u=h[a]]=u}s[o]=["function(require,module,exports){"+t+"(self); }",d]}var p=Math.floor(Math.pow(16,8)*Math.random()).toString(16),f={};f[o]=o,s[p]=["function(require,module,exports){var f = require("+n(o)+");(f.default ? f.default : f)(self);}",f];var g={};!function t(e){for(var r in g[e]=!0,s[e][1]){var n=s[e][1][r];g[n]||t(n)}}(p);var v="("+e+")({"+Object.keys(g).map((function(t){return n(t)+":["+s[t][0]+","+n(s[t][1])+"]"})).join(",")+"},{},["+n(p)+"])",b=window.URL||window.webkitURL||window.mozURL||window.msURL,y=new Blob([v],{type:"text/javascript"});if(i&&i.bare)return y;var w=b.createObjectURL(y),E=new Worker(w);return E.objectURL=w,E}}}]);