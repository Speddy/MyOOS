(self.webpackChunkmetaverse_experience=self.webpackChunkmetaverse_experience||[]).push([[339],{4921:function(t,e,s){const i=s(1416);AFRAME.registerComponent("clickable",AFRAME.utils.extendDeep({},i,{schema:{onclick:{type:"string"}},init:function(){this.CLICKED_STATE="clicked",this.CLICK_EVENT="grab-start",this.UNCLICK_EVENT="grab-end",this.clickers=[],this.start=this.start.bind(this),this.end=this.end.bind(this),this.el.addEventListener(this.CLICK_EVENT,this.start),this.el.addEventListener(this.UNCLICK_EVENT,this.end)},remove:function(){this.el.removeEventListener(this.CLICK_EVENT,this.start),this.el.removeEventListener(this.UNCLICK_EVENT,this.end)},start:function(t){!t.defaultPrevented&&this.startButtonOk(t)&&(this.el.addState(this.CLICKED_STATE),-1===this.clickers.indexOf(t.detail.hand)&&(this.clickers.push(t.detail.hand),t.preventDefault&&t.preventDefault()))},end:function(t){const e=this.clickers.indexOf(t.detail.hand);!t.defaultPrevented&&this.endButtonOk(t)&&(-1!==e&&this.clickers.splice(e,1),this.clickers.length<1&&this.el.removeState(this.CLICKED_STATE),t.preventDefault&&t.preventDefault())}}))},1708:function(t,e,s){const i=AFRAME.utils.extendDeep,n=s(1416);AFRAME.registerComponent("drag-droppable",i({},n,{init:function(){console.warn("Warning: drag-droppable is deprecated. Use draggable and droppable components instead"),this.HOVERED_STATE="dragover",this.DRAGGED_STATE="dragged",this.HOVER_EVENT="dragover-start",this.UNHOVER_EVENT="dragover-end",this.DRAG_EVENT="drag-start",this.UNDRAG_EVENT="drag-end",this.DRAGDROP_EVENT="drag-drop",this.hoverStart=this.hoverStart.bind(this),this.dragStart=this.dragStart.bind(this),this.hoverEnd=this.hoverEnd.bind(this),this.dragEnd=this.dragEnd.bind(this),this.dragDrop=this.dragDrop.bind(this),this.el.addEventListener(this.HOVER_EVENT,this.hoverStart),this.el.addEventListener(this.DRAG_EVENT,this.dragStart),this.el.addEventListener(this.UNHOVER_EVENT,this.hoverEnd),this.el.addEventListener(this.UNDRAG_EVENT,this.dragEnd),this.el.addEventListener(this.DRAGDROP_EVENT,this.dragDrop)},remove:function(){this.el.removeEventListener(this.HOVER_EVENT,this.hoverStart),this.el.removeEventListener(this.DRAG_EVENT,this.dragStart),this.el.removeEventListener(this.UNHOVER_EVENT,this.hoverEnd),this.el.removeEventListener(this.UNDRAG_EVENT,this.dragEnd),this.el.removeEventListener(this.DRAGDROP_EVENT,this.dragDrop)},hoverStart:function(t){this.el.addState(this.HOVERED_STATE),t.preventDefault&&t.preventDefault()},dragStart:function(t){this.startButtonOk(t)&&(this.el.addState(this.DRAGGED_STATE),t.preventDefault&&t.preventDefault())},hoverEnd:function(t){this.el.removeState(this.HOVERED_STATE)},dragEnd:function(t){this.endButtonOk(t)&&(this.el.removeState(this.DRAGGED_STATE),t.preventDefault&&t.preventDefault())},dragDrop:function(t){this.endButtonOk(t)&&t.preventDefault&&t.preventDefault()}}))},711:function(t,e,s){const i=AFRAME.utils.extendDeep,n=s(1416);AFRAME.registerComponent("draggable",i({},n,{init:function(){this.DRAGGED_STATE="dragged",this.DRAG_EVENT="drag-start",this.UNDRAG_EVENT="drag-end",this.dragStartBound=this.dragStart.bind(this),this.dragEndBound=this.dragEnd.bind(this),this.el.addEventListener(this.DRAG_EVENT,this.dragStartBound),this.el.addEventListener(this.UNDRAG_EVENT,this.dragEndBound)},remove:function(){this.el.removeEventListener(this.DRAG_EVENT,this.dragStart),this.el.removeEventListener(this.UNDRAG_EVENT,this.dragEnd)},dragStart:function(t){!t.defaultPrevented&&this.startButtonOk(t)&&(this.el.addState(this.DRAGGED_STATE),t.preventDefault&&t.preventDefault())},dragEnd:function(t){!t.defaultPrevented&&this.endButtonOk(t)&&(this.el.removeState(this.DRAGGED_STATE),t.preventDefault&&t.preventDefault())}}))},9514:function(){AFRAME.registerComponent("droppable",{schema:{accepts:{default:""},autoUpdate:{default:!0},acceptEvent:{default:""},rejectEvent:{default:""}},multiple:!0,init:function(){this.HOVERED_STATE="dragover",this.HOVER_EVENT="dragover-start",this.UNHOVER_EVENT="dragover-end",this.DRAGDROP_EVENT="drag-drop",this.hoverStartBound=this.hoverStart.bind(this),this.hoverEndBound=this.hoverEnd.bind(this),this.dragDropBound=this.dragDrop.bind(this),this.mutateAcceptsBound=this.mutateAccepts.bind(this),this.acceptableEntities=[],this.observer=new window.MutationObserver(this.mutateAcceptsBound),this.observerOpts={childList:!0,subtree:!0},this.el.addEventListener(this.HOVER_EVENT,this.hoverStartBound),this.el.addEventListener(this.UNHOVER_EVENT,this.hoverEndBound),this.el.addEventListener(this.DRAGDROP_EVENT,this.dragDropBound)},update:function(){this.data.accepts.length?this.acceptableEntities=Array.prototype.slice.call(this.el.sceneEl.querySelectorAll(this.data.accepts)):this.acceptableEntities=null,this.data.autoUpdate&&null!=this.acceptableEntities?this.observer.observe(this.el.sceneEl,this.observerOpts):this.observer.disconnect()},remove:function(){this.el.removeEventListener(this.HOVER_EVENT,this.hoverStartBound),this.el.removeEventListener(this.UNHOVER_EVENT,this.hoverEndBound),this.el.removeEventListener(this.DRAGDROP_EVENT,this.dragDropBound),this.observer.disconnect()},mutateAccepts:function(t){const e=this.data.accepts;t.forEach((t=>{t.addedNodes.forEach((t=>{var s,i;i=e,((s=t).matches?s.matches(i):s.msMatchesSelector?s.msMatchesSelector(i):s.webkitMatchesSelector?s.webkitMatchesSelector(i):void 0)&&this.acceptableEntities.push(t)}))}))},entityAcceptable:function(t){const e=this.acceptableEntities;if(null==e)return!0;for(const s of e)if(s===t)return!0;return!1},hoverStart:function(t){!t.defaultPrevented&&this.entityAcceptable(t.detail.carried)&&(this.el.addState(this.HOVERED_STATE),t.preventDefault&&t.preventDefault())},hoverEnd:function(t){t.defaultPrevented||this.el.removeState(this.HOVERED_STATE)},dragDrop:function(t){if(t.defaultPrevented)return;const e=t.detail.dropped;this.entityAcceptable(e)?(this.data.acceptEvent.length&&this.el.emit(this.data.acceptEvent,{el:e}),t.preventDefault&&t.preventDefault()):this.data.rejectEvent.length&&this.el.emit(this.data.rejectEvent,{el:e})}})},6832:function(t,e,s){const i=AFRAME.utils.extendDeep,n=i({},s(2945),s(1416));AFRAME.registerComponent("grabbable",i(n,{schema:{maxGrabbers:{type:"int",default:NaN},invert:{default:!1},suppressY:{default:!1}},init:function(){this.GRABBED_STATE="grabbed",this.GRAB_EVENT="grab-start",this.UNGRAB_EVENT="grab-end",this.grabbed=!1,this.grabbers=[],this.constraints=new Map,this.deltaPositionIsValid=!1,this.grabDistance=void 0,this.grabDirection={x:0,y:0,z:-1},this.grabOffset={x:0,y:0,z:0},this.destPosition={x:0,y:0,z:0},this.deltaPosition=new THREE.Vector3,this.targetPosition=new THREE.Vector3,this.physicsInit(),this.el.addEventListener(this.GRAB_EVENT,(t=>this.start(t))),this.el.addEventListener(this.UNGRAB_EVENT,(t=>this.end(t))),this.el.addEventListener("mouseout",(t=>this.lostGrabber(t)))},update:function(){this.physicsUpdate(),this.xFactor=this.data.invert?-1:1,this.zFactor=this.data.invert?-1:1,this.yFactor=(this.data.invert?-1:1)*!this.data.suppressY},tick:function(){const t=new THREE.Quaternion,e=new THREE.Vector3;return function(){let s;this.grabber&&(this.targetPosition.copy(this.grabDirection),this.targetPosition.applyQuaternion(this.grabber.object3D.getWorldQuaternion(t)).setLength(this.grabDistance).add(this.grabber.object3D.getWorldPosition(e)).add(this.grabOffset),this.deltaPositionIsValid?(this.deltaPosition.sub(this.targetPosition),s=this.el.getAttribute("position"),this.destPosition.x=s.x-this.deltaPosition.x*this.xFactor,this.destPosition.y=s.y-this.deltaPosition.y*this.yFactor,this.destPosition.z=s.z-this.deltaPosition.z*this.zFactor,this.el.setAttribute("position",this.destPosition)):this.deltaPositionIsValid=!0,this.deltaPosition.copy(this.targetPosition))}}(),remove:function(){this.el.removeEventListener(this.GRAB_EVENT,this.start),this.el.removeEventListener(this.UNGRAB_EVENT,this.end),this.physicsRemove()},start:function(t){if(t.defaultPrevented||!this.startButtonOk(t))return;const e=!Number.isFinite(this.data.maxGrabbers)||this.grabbers.length<this.data.maxGrabbers;if(-1===this.grabbers.indexOf(t.detail.hand)&&e){if(!t.detail.hand.object3D)return void console.warn("grabbable entities must have an object3D");this.grabbers.push(t.detail.hand),this.physicsStart(t)||this.grabber||(this.grabber=t.detail.hand,this.resetGrabber()),t.preventDefault&&t.preventDefault(),this.grabbed=!0,this.el.addState(this.GRABBED_STATE)}},end:function(t){const e=this.grabbers.indexOf(t.detail.hand);!t.defaultPrevented&&this.endButtonOk(t)&&(-1!==e&&(this.grabbers.splice(e,1),this.grabber=this.grabbers[0]),this.physicsEnd(t),this.resetGrabber()||(this.grabbed=!1,this.el.removeState(this.GRABBED_STATE)),t.preventDefault&&t.preventDefault())},resetGrabber:function(){const t=new THREE.Vector3,e=new THREE.Vector3;return function(){if(!this.grabber)return!1;const s=this.grabber.getAttribute("raycaster");return this.deltaPositionIsValid=!1,this.grabDistance=this.el.object3D.getWorldPosition(t).distanceTo(this.grabber.object3D.getWorldPosition(e)),s&&(this.grabDirection=s.direction,this.grabOffset=s.origin),!0}}(),lostGrabber:function(t){const e=this.grabbers.indexOf(t.relatedTarget);-1===e||t.relatedTarget===this.grabber||this.physicsIsConstrained(t.relatedTarget)||this.grabbers.splice(e,1)}}))},2585:function(){AFRAME.registerComponent("hoverable",{init:function(){this.HOVERED_STATE="hovered",this.HOVER_EVENT="hover-start",this.UNHOVER_EVENT="hover-end",this.hoverers=[],this.start=this.start.bind(this),this.end=this.end.bind(this),this.el.addEventListener(this.HOVER_EVENT,this.start),this.el.addEventListener(this.UNHOVER_EVENT,this.end)},remove:function(){this.el.removeEventListener(this.HOVER_EVENT,this.start),this.el.removeEventListener(this.UNHOVER_EVENT,this.end)},start:function(t){t.defaultPrevented||(this.el.addState(this.HOVERED_STATE),-1===this.hoverers.indexOf(t.detail.hand)&&this.hoverers.push(t.detail.hand),t.preventDefault&&t.preventDefault())},end:function(t){if(t.defaultPrevented)return;const e=this.hoverers.indexOf(t.detail.hand);-1!==e&&this.hoverers.splice(e,1),this.hoverers.length<1&&this.el.removeState(this.HOVERED_STATE)}})},1416:function(t){t.exports=function(){function t(t,e){return 0===e.length||-1!==e.indexOf(t.detail.buttonEvent.type)}return{schema:{startButtons:{default:[]},endButtons:{default:[]}},startButtonOk:function(e){return t(e,this.data.startButtons)},endButtonOk:function(e){return t(e,this.data.endButtons)}}}()},2945:function(t){t.exports={schema:{usePhysics:{default:"ifavailable"}},physicsInit:function(){this.constraints=new Map},physicsUpdate:function(){"never"===this.data.usePhysics&&this.constraints.size&&this.physicsClear()},physicsRemove:function(){this.physicsClear()},physicsStart:function(t){if("never"!==this.data.usePhysics&&this.el.body&&t.detail.hand.body&&!this.constraints.has(t.detail.hand)){const e=Math.random().toString(36).substr(2,9);return this.el.setAttribute("constraint__"+e,{target:t.detail.hand}),this.constraints.set(t.detail.hand,e),!0}return"only"===this.data.usePhysics},physicsEnd:function(t){const e=this.constraints.get(t.detail.hand);e&&(this.el.removeAttribute("constraint__"+e),this.constraints.delete(t.detail.hand))},physicsClear:function(){if(this.el.body)for(const t of this.constraints.values())this.el.body.world.removeConstraint(t);this.constraints.clear()},physicsIsConstrained:function(t){return this.constraints.has(t)},physicsIsGrabbing(){return this.constraints.size>0}}},4336:function(t,e,s){const i=AFRAME.utils.extendDeep,n=i({},s(1416));AFRAME.registerComponent("stretchable",i(n,{schema:{usePhysics:{default:"ifavailable"},invert:{default:!1},physicsUpdateRate:{default:100}},init:function(){this.STRETCHED_STATE="stretched",this.STRETCH_EVENT="stretch-start",this.UNSTRETCH_EVENT="stretch-end",this.stretched=!1,this.stretchers=[],this.scale=new THREE.Vector3,this.handPos=new THREE.Vector3,this.otherHandPos=new THREE.Vector3,this.start=this.start.bind(this),this.end=this.end.bind(this),this.el.addEventListener(this.STRETCH_EVENT,this.start),this.el.addEventListener(this.UNSTRETCH_EVENT,this.end)},update:function(t){this.updateBodies=AFRAME.utils.throttleTick(this._updateBodies,this.data.physicsUpdateRate,this)},tick:function(t,e){if(!this.stretched)return;this.scale.copy(this.el.getAttribute("scale")),this.stretchers[0].object3D.getWorldPosition(this.handPos),this.stretchers[1].object3D.getWorldPosition(this.otherHandPos);const s=this.handPos.distanceTo(this.otherHandPos);let i=1;null!==this.previousStretch&&0!==s&&(i=Math.pow(s/this.previousStretch,this.data.invert?-1:1)),this.previousStretch=s,null==this.previousPhysicsStretch&&(this.previousPhysicsStretch=s),this.scale.multiplyScalar(i),this.el.setAttribute("scale",this.scale),this.updateBodies(t,e)},remove:function(){this.el.removeEventListener(this.STRETCH_EVENT,this.start),this.el.removeEventListener(this.UNSTRETCH_EVENT,this.end)},start:function(t){this.stretched||this.stretchers.includes(t.detail.hand)||!this.startButtonOk(t)||t.defaultPrevented||(this.stretchers.push(t.detail.hand),2===this.stretchers.length&&(this.stretched=!0,this.previousStretch=null,this.previousPhysicsStretch=null,this.el.addState(this.STRETCHED_STATE)),t.preventDefault&&t.preventDefault())},end:function(t){const e=this.stretchers.indexOf(t.detail.hand);!t.defaultPrevented&&this.endButtonOk(t)&&(-1!==e&&(this.stretchers.splice(e,1),this.stretched=!1,this.el.removeState(this.STRETCHED_STATE),this._updateBodies()),t.preventDefault&&t.preventDefault())},_updateBodies:function(){if(!this.el.body||"never"===this.data.usePhysics)return;const t=this.previousStretch;let e=1;if(null!==this.previousPhysicsStretch&&t>0&&(e=Math.pow(t/this.previousPhysicsStretch,this.data.invert?-1:1)),this.previousPhysicsStretch=t,1!==e){for(const t of this.el.childNodes)this.stretchBody(t,e);this.stretchBody(this.el,e)}},stretchBody:function(t,e){if(!t.body)return;let s,i;for(let n=0;n<t.body.shapes.length;n++)s=t.body.shapes[n],s.halfExtents?(s.halfExtents.scale(e,s.halfExtents),s.updateConvexPolyhedronRepresentation()):s.radius?(s.radius*=e,s.updateBoundingSphereRadius()):this.shapeWarned||(console.warn("Unable to stretch physics body: unsupported shape"),this.shapeWarned=!0),i=t.body.shapeOffsets[n],i.scale(e,i);t.body.updateBoundingRadius()}}))},2040:function(){AFRAME.registerSystem("super-hands",{init:function(){this.superHands=[]},registerMe:function(t){1===this.superHands.length&&(this.superHands[0].otherSuperHand=t,t.otherSuperHand=this.superHands[0]),this.superHands.push(t)},unregisterMe:function(t){const e=this.superHands.indexOf(t);-1!==e&&this.superHands.splice(e,1),this.superHands.forEach((e=>{e.otherSuperHand===t&&(e.otherSuperHand=null)}))}})},6594:function(t,e,s){"use strict";s.r(e),s.d(e,{Pathfinding:function(){return h},PathfindingHelper:function(){return d}});var i=s(9477);class n{static roundNumber(t,e){const s=Math.pow(10,e);return Math.round(t*s)/s}static sample(t){return t[Math.floor(Math.random()*t.length)]}static distanceToSquared(t,e){var s=t.x-e.x,i=t.y-e.y,n=t.z-e.z;return s*s+i*i+n*n}static isPointInPoly(t,e){for(var s=!1,i=-1,n=t.length,r=n-1;++i<n;r=i)(t[i].z<=e.z&&e.z<t[r].z||t[r].z<=e.z&&e.z<t[i].z)&&e.x<(t[r].x-t[i].x)*(e.z-t[i].z)/(t[r].z-t[i].z)+t[i].x&&(s=!s);return s}static isVectorInPolygon(t,e,s){var i=1e5,n=-1e5,r=[];return e.vertexIds.forEach((t=>{i=Math.min(s[t].y,i),n=Math.max(s[t].y,n),r.push(s[t])})),!!(t.y<n+.5&&t.y>i-.5&&this.isPointInPoly(r,t))}static triarea2(t,e,s){return(s.x-t.x)*(e.z-t.z)-(e.x-t.x)*(s.z-t.z)}static vequal(t,e){return this.distanceToSquared(t,e)<1e-5}static mergeVertices(t,e=1e-4){e=Math.max(e,Number.EPSILON);for(var s={},n=t.getIndex(),r=t.getAttribute("position"),o=n?n.count:r.count,h=0,a=[],d=[],c=Math.log10(1/e),u=Math.pow(10,c),l=0;l<o;l++){var p=n?n.getX(l):l,E="";E+=~~(r.getX(p)*u)+",",E+=~~(r.getY(p)*u)+",",(E+=~~(r.getZ(p)*u)+",")in s?a.push(s[E]):(d.push(r.getX(p)),d.push(r.getY(p)),d.push(r.getZ(p)),s[E]=h,a.push(h),h++)}const v=new i.TlE(new Float32Array(d),r.itemSize,r.normalized),f=new i.u9r;return f.setAttribute("position",v),f.setIndex(a),f}}class r{constructor(t){this.content=[],this.scoreFunction=t}push(t){this.content.push(t),this.sinkDown(this.content.length-1)}pop(){const t=this.content[0],e=this.content.pop();return this.content.length>0&&(this.content[0]=e,this.bubbleUp(0)),t}remove(t){const e=this.content.indexOf(t),s=this.content.pop();e!==this.content.length-1&&(this.content[e]=s,this.scoreFunction(s)<this.scoreFunction(t)?this.sinkDown(e):this.bubbleUp(e))}size(){return this.content.length}rescoreElement(t){this.sinkDown(this.content.indexOf(t))}sinkDown(t){const e=this.content[t];for(;t>0;){const s=(t+1>>1)-1,i=this.content[s];if(!(this.scoreFunction(e)<this.scoreFunction(i)))break;this.content[s]=e,this.content[t]=i,t=s}}bubbleUp(t){const e=this.content.length,s=this.content[t],i=this.scoreFunction(s);for(;;){const n=t+1<<1,r=n-1;let o,h=null;if(r<e&&(o=this.scoreFunction(this.content[r]),o<i&&(h=r)),n<e&&this.scoreFunction(this.content[n])<(null===h?i:o)&&(h=n),null===h)break;this.content[t]=this.content[h],this.content[h]=s,t=h}}}class o{constructor(){this.portals=[]}push(t,e){void 0===e&&(e=t),this.portals.push({left:t,right:e})}stringPull(){const t=this.portals,e=[];let s,i,r,o=0,h=0,a=0;s=t[0].left,i=t[0].left,r=t[0].right,e.push(s);for(let d=1;d<t.length;d++){const c=t[d].left,u=t[d].right;if(n.triarea2(s,r,u)<=0){if(!(n.vequal(s,r)||n.triarea2(s,i,u)>0)){e.push(i),s=i,o=h,i=s,r=s,h=o,a=o,d=o;continue}r=u,a=d}if(n.triarea2(s,i,c)>=0){if(!(n.vequal(s,i)||n.triarea2(s,r,c)<0)){e.push(r),s=r,o=a,i=s,r=s,h=o,a=o,d=o;continue}i=c,h=d}}return 0!==e.length&&n.vequal(e[e.length-1],t[t.length-1].left)||e.push(t[t.length-1].left),this.path=e,e}}class h{constructor(){this.zones={}}static createZone(t,e=1e-4){return class{static buildZone(t,e){const s=this._buildNavigationMesh(t,e),r={};s.vertices.forEach((t=>{t.x=n.roundNumber(t.x,2),t.y=n.roundNumber(t.y,2),t.z=n.roundNumber(t.z,2)})),r.vertices=s.vertices;const o=this._buildPolygonGroups(s);return r.groups=new Array(o.length),o.forEach(((t,e)=>{const s=new Map;t.forEach(((t,e)=>{s.set(t,e)}));const o=new Array(t.length);t.forEach(((t,e)=>{const h=[];t.neighbours.forEach((t=>h.push(s.get(t))));const a=[];t.neighbours.forEach((e=>a.push(this._getSharedVerticesInOrder(t,e))));const d=new i.Pa4(0,0,0);d.add(r.vertices[t.vertexIds[0]]),d.add(r.vertices[t.vertexIds[1]]),d.add(r.vertices[t.vertexIds[2]]),d.divideScalar(3),d.x=n.roundNumber(d.x,2),d.y=n.roundNumber(d.y,2),d.z=n.roundNumber(d.z,2),o[e]={id:e,neighbours:h,vertexIds:t.vertexIds,centroid:d,portals:a}})),r.groups[e]=o})),r}static _buildNavigationMesh(t,e){return t=n.mergeVertices(t,e),this._buildPolygonsFromGeometry(t)}static _spreadGroupId(t){let e=new Set([t]);for(;e.size>0;){const s=e;e=new Set,s.forEach((s=>{s.group=t.group,s.neighbours.forEach((t=>{void 0===t.group&&e.add(t)}))}))}}static _buildPolygonGroups(t){const e=[];return t.polygons.forEach((t=>{void 0!==t.group?e[t.group].push(t):(t.group=e.length,this._spreadGroupId(t),e.push([t]))})),e}static _buildPolygonNeighbours(t,e){const s=new Set,i=e[t.vertexIds[1]],n=e[t.vertexIds[2]];return e[t.vertexIds[0]].forEach((e=>{e!==t&&(i.includes(e)||n.includes(e))&&s.add(e)})),i.forEach((e=>{e!==t&&n.includes(e)&&s.add(e)})),s}static _buildPolygonsFromGeometry(t){const e=[],s=[],n=t.attributes.position,r=t.index,o=[];for(let t=0;t<n.count;t++)s.push((new i.Pa4).fromBufferAttribute(n,t)),o[t]=[];for(let s=0;s<t.index.count;s+=3){const t=r.getX(s),i=r.getX(s+1),n=r.getX(s+2),h={vertexIds:[t,i,n],neighbours:null};e.push(h),o[t].push(h),o[i].push(h),o[n].push(h)}return e.forEach((t=>{t.neighbours=this._buildPolygonNeighbours(t,o)})),{polygons:e,vertices:s}}static _getSharedVerticesInOrder(t,e){const s=t.vertexIds,i=s[0],n=s[1],r=s[2],o=e.vertexIds,h=o.includes(i),a=o.includes(n),d=o.includes(r);return h&&a&&d?Array.from(s):h&&a?[i,n]:a&&d?[n,r]:h&&d?[r,i]:(console.warn("Error processing navigation mesh neighbors; neighbors with <2 shared vertices found."),[])}}.buildZone(t,e)}setZoneData(t,e){this.zones[t]=e}getRandomNode(t,e,s,r){if(!this.zones[t])return new i.Pa4;s=s||null,r=r||0;const o=[];return this.zones[t].groups[e].forEach((t=>{s&&r?n.distanceToSquared(s,t.centroid)<r*r&&o.push(t.centroid):o.push(t.centroid)})),n.sample(o)||new i.Pa4}getClosestNode(t,e,s,i=!1){const r=this.zones[e].vertices;let o=null,h=1/0;return this.zones[e].groups[s].forEach((e=>{const s=n.distanceToSquared(e.centroid,t);s<h&&(!i||n.isVectorInPolygon(t,e,r))&&(o=e,h=s)})),o}findPath(t,e,s,h){const a=this.zones[s].groups[h],d=this.zones[s].vertices,c=this.getClosestNode(t,s,h,!0),u=this.getClosestNode(e,s,h,!0);if(!c||!u)return null;const l=class{static init(t){for(let e=0;e<t.length;e++){const s=t[e];s.f=0,s.g=0,s.h=0,s.cost=1,s.visited=!1,s.closed=!1,s.parent=null}}static cleanUp(t){for(let e=0;e<t.length;e++){const s=t[e];delete s.f,delete s.g,delete s.h,delete s.cost,delete s.visited,delete s.closed,delete s.parent}}static heap(){return new r((function(t){return t.f}))}static search(t,e,s){this.init(t);const i=this.heap();for(i.push(e);i.size()>0;){const e=i.pop();if(e===s){let t=e;const s=[];for(;t.parent;)s.push(t),t=t.parent;return this.cleanUp(s),s.reverse()}e.closed=!0;const n=this.neighbours(t,e);for(let t=0,r=n.length;t<r;t++){const r=n[t];if(r.closed)continue;const o=e.g+r.cost,h=r.visited;if(!h||o<r.g){if(r.visited=!0,r.parent=e,!r.centroid||!s.centroid)throw new Error("Unexpected state");r.h=r.h||this.heuristic(r.centroid,s.centroid),r.g=o,r.f=r.g+r.h,h?i.rescoreElement(r):i.push(r)}}}return[]}static heuristic(t,e){return n.distanceToSquared(t,e)}static neighbours(t,e){const s=[];for(let i=0;i<e.neighbours.length;i++)s.push(t[e.neighbours[i]]);return s}}.search(a,c,u),p=function(t,e){for(var s=0;s<t.neighbours.length;s++)if(t.neighbours[s]===e.id)return t.portals[s]},E=new o;E.push(t);for(let t=0;t<l.length;t++){const e=l[t],s=l[t+1];if(s){const t=p(e,s);E.push(d[t[0]],d[t[1]])}}E.push(e),E.stringPull();const v=E.path.map((t=>new i.Pa4(t.x,t.y,t.z)));return v.shift(),v}}h.prototype.getGroup=function(){const t=new i.JOQ;return function(e,s,i=!1){if(!this.zones[e])return null;let r=null,o=Math.pow(50,2);const h=this.zones[e];for(let e=0;e<h.groups.length;e++){const a=h.groups[e];for(const d of a){if(i&&(t.setFromCoplanarPoints(h.vertices[d.vertexIds[0]],h.vertices[d.vertexIds[1]],h.vertices[d.vertexIds[2]]),Math.abs(t.distanceToPoint(s))<.01)&&n.isPointInPoly([h.vertices[d.vertexIds[0]],h.vertices[d.vertexIds[1]],h.vertices[d.vertexIds[2]]],s))return e;const a=n.distanceToSquared(d.centroid,s);a<o&&(r=e,o=a)}}return r}}(),h.prototype.clampStep=function(){const t=new i.Pa4,e=new i.JOQ,s=new i.CJI,n=new i.Pa4;let r,o,h=new i.Pa4;return function(i,a,d,c,u,l){const p=this.zones[c].vertices,E=this.zones[c].groups[u],v=[d],f={};f[d.id]=0,r=void 0,h.set(0,0,0),o=1/0,e.setFromCoplanarPoints(p[d.vertexIds[0]],p[d.vertexIds[1]],p[d.vertexIds[2]]),e.projectPoint(a,t),n.copy(t);for(let e=v.pop();e;e=v.pop()){s.set(p[e.vertexIds[0]],p[e.vertexIds[1]],p[e.vertexIds[2]]),s.closestPointToPoint(n,t),t.distanceToSquared(n)<o&&(r=e,h.copy(t),o=t.distanceToSquared(n));const i=f[e.id];if(!(i>2))for(let t=0;t<e.neighbours.length;t++){const s=E[e.neighbours[t]];s.id in f||(v.push(s),f[s.id]=i+1)}}return l.copy(h),r}}();const a={PLAYER:new i.Ilk(15631215).convertSRGBToLinear().getHex(),TARGET:new i.Ilk(14469912).convertSRGBToLinear().getHex(),PATH:new i.Ilk(41903).convertSRGBToLinear().getHex(),WAYPOINT:new i.Ilk(41903).convertSRGBToLinear().getHex(),CLAMPED_STEP:new i.Ilk(14472114).convertSRGBToLinear().getHex(),CLOSEST_NODE:new i.Ilk(4417387).convertSRGBToLinear().getHex()};class d extends i.Tme{constructor(){super(),this._playerMarker=new i.Kj0(new i.xo$(.25,32,32),new i.vBJ({color:a.PLAYER})),this._targetMarker=new i.Kj0(new i.DvJ(.3,.3,.3),new i.vBJ({color:a.TARGET})),this._nodeMarker=new i.Kj0(new i.DvJ(.1,.8,.1),new i.vBJ({color:a.CLOSEST_NODE})),this._stepMarker=new i.Kj0(new i.DvJ(.1,1,.1),new i.vBJ({color:a.CLAMPED_STEP})),this._pathMarker=new i.Tme,this._pathLineMaterial=new i.nls({color:a.PATH,linewidth:2}),this._pathPointMaterial=new i.vBJ({color:a.WAYPOINT}),this._pathPointGeometry=new i.xo$(.08),this._markers=[this._playerMarker,this._targetMarker,this._nodeMarker,this._stepMarker,this._pathMarker],this._markers.forEach((t=>{t.visible=!1,this.add(t)}))}setPath(t){for(;this._pathMarker.children.length;)this._pathMarker.children[0].visible=!1,this._pathMarker.remove(this._pathMarker.children[0]);t=[this._playerMarker.position].concat(t);const e=new i.u9r;e.setAttribute("position",new i.TlE(new Float32Array(3*t.length),3));for(let s=0;s<t.length;s++)e.attributes.position.setXYZ(s,t[s].x,t[s].y+.2,t[s].z);this._pathMarker.add(new i.x12(e,this._pathLineMaterial));for(let e=0;e<t.length-1;e++){const s=new i.Kj0(this._pathPointGeometry,this._pathPointMaterial);s.position.copy(t[e]),s.position.y+=.2,this._pathMarker.add(s)}return this._pathMarker.visible=!0,this}setPlayerPosition(t){return this._playerMarker.position.copy(t),this._playerMarker.visible=!0,this}setTargetPosition(t){return this._targetMarker.position.copy(t),this._targetMarker.visible=!0,this}setNodePosition(t){return this._nodeMarker.position.copy(t),this._nodeMarker.visible=!0,this}setStepPosition(t){return this._stepMarker.position.copy(t),this._stepMarker.visible=!0,this}reset(){for(;this._pathMarker.children.length;)this._pathMarker.children[0].visible=!1,this._pathMarker.remove(this._pathMarker.children[0]);return this._markers.forEach((t=>{t.visible=!1})),this}}},8034:function(t){var e=arguments[3],s=arguments[4],i=arguments[5],n=JSON.stringify;t.exports=function(t,r){for(var o,h=Object.keys(i),a=0,d=h.length;a<d;a++){var c=h[a],u=i[c].exports;if(u===t||u&&u.default===t){o=c;break}}if(!o){o=Math.floor(Math.pow(16,8)*Math.random()).toString(16);var l={};for(a=0,d=h.length;a<d;a++){l[c=h[a]]=c}s[o]=["function(require,module,exports){"+t+"(self); }",l]}var p=Math.floor(Math.pow(16,8)*Math.random()).toString(16),E={};E[o]=o,s[p]=["function(require,module,exports){var f = require("+n(o)+");(f.default ? f.default : f)(self);}",E];var v={};!function t(e){for(var i in v[e]=!0,s[e][1]){var n=s[e][1][i];v[n]||t(n)}}(p);var f="("+e+")({"+Object.keys(v).map((function(t){return n(t)+":["+s[t][0]+","+n(s[t][1])+"]"})).join(",")+"},{},["+n(p)+"])",g=window.URL||window.webkitURL||window.mozURL||window.msURL,b=new Blob([f],{type:"text/javascript"});if(r&&r.bare)return b;var T=g.createObjectURL(b),_=new Worker(T);return _.objectURL=T,_}}}]);