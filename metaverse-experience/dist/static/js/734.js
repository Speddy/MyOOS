(self.webpackChunkmetaverse_experience=self.webpackChunkmetaverse_experience||[]).push([[734],{401:function(t,e,n){n(2406),n(9874),n(9236),n(2578),n(6699)},6453:function(t){t.exports=Object.assign((function(){}),{FACE_1:0,FACE_2:1,FACE_3:2,FACE_4:3,L_SHOULDER_1:4,R_SHOULDER_1:5,L_SHOULDER_2:6,R_SHOULDER_2:7,SELECT:8,START:9,DPAD_UP:12,DPAD_DOWN:13,DPAD_LEFT:14,DPAD_RIGHT:15,VENDOR:16})},4379:function(t){t.exports=function(t,e,n){this.type=t,this.index=e,this.pressed=n.pressed,this.value=n.value}},4657:function(t){function e(t){const e=document.getElementById(t),n=e.parentNode;try{n&&n.removeChild(e)}catch(t){}}function n(t,n,i){return new i((function(i,o){const s=n.timeout||5e3,c="script_"+Date.now()+"_"+Math.ceil(1e5*Math.random()),r=function(t,e){var n=document.createElement("script");return n.type="text/javascript",n.async=!0,n.id=e,n.src=t,n}(t,c),a=setTimeout((function(){o(new Error("Script request to "+t+" timed out")),e(c)}),s),h=function(t){clearTimeout(t)};r.addEventListener("load",(function(t){i({ok:!0}),h(a),e(c)})),r.addEventListener("error",(function(n){o(new Error("Script request to "+t+" failed "+n)),h(a),e(c)})),function(t){const e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}(r)}))}t.exports=function(t){return t=t||{},function(e,i){return n(e,i=i||{},t.Promise||Promise)}}},3386:function(t){t.exports=AFRAME.registerComponent("checkpoint-controls",{schema:{enabled:{default:!0},mode:{default:"teleport",oneOf:["teleport","animate"]},animateSpeed:{default:3}},init:function(){this.active=!0,this.checkpoint=null,this.isNavMeshConstrained=!1,this.offset=new THREE.Vector3,this.position=new THREE.Vector3,this.targetPosition=new THREE.Vector3},play:function(){this.active=!0},pause:function(){this.active=!1},setCheckpoint:function(t){const e=this.el;this.active&&this.checkpoint!==t&&(this.checkpoint&&e.emit("navigation-end",{checkpoint:this.checkpoint}),this.checkpoint=t,this.sync(),this.position.distanceTo(this.targetPosition)<.1?this.checkpoint=null:(e.emit("navigation-start",{checkpoint:t}),"teleport"===this.data.mode&&(this.el.setAttribute("position",this.targetPosition),this.checkpoint=null,e.emit("navigation-end",{checkpoint:t}),e.components["movement-controls"].updateNavLocation())))},isVelocityActive:function(){return!(!this.active||!this.checkpoint)},getVelocity:function(){if(!this.active)return;const t=this.data,e=this.offset,n=this.position,i=this.targetPosition,o=this.checkpoint;return this.sync(),n.distanceTo(i)<.1?(this.checkpoint=null,this.el.emit("navigation-end",{checkpoint:o}),e.set(0,0,0)):(e.setLength(t.animateSpeed),e)},sync:function(){const t=this.offset,e=this.position,n=this.targetPosition;e.copy(this.el.getAttribute("position")),this.checkpoint.object3D.getWorldPosition(n),n.add(this.checkpoint.components.checkpoint.getOffset()),t.copy(n).sub(e)}})},5062:function(t,e,n){const i=n(6453),o=n(4379),s=.2,c="left",r="right",a=1,h=2;t.exports=AFRAME.registerComponent("gamepad-controls",{GamepadButton:i,schema:{enabled:{default:!0},rotationSensitivity:{default:2}},init:function(){const t=this.el.sceneEl;this.system=t.systems["tracked-controls-webxr"]||{controllers:[]},this.prevTime=window.performance.now(),this.buttons={};const e=this.el.object3D.rotation;this.pitch=new THREE.Object3D,this.pitch.rotation.x=e.x,this.yaw=new THREE.Object3D,this.yaw.position.y=10,this.yaw.rotation.y=e.y,this.yaw.add(this.pitch),this._lookVector=new THREE.Vector2,this._moveVector=new THREE.Vector2,this._dpadVector=new THREE.Vector2,t.addBehavior(this)},update:function(){this.tick()},tick:function(t,e){this.updateButtonState(),this.updateRotation(e)},remove:function(){},isVelocityActive:function(){if(!this.data.enabled||!this.isConnected())return!1;const t=this._dpadVector,e=this._moveVector;this.getDpad(t),this.getJoystick(a,e);const n=t.x||e.x,i=t.y||e.y;return Math.abs(n)>s||Math.abs(i)>s},getVelocityDelta:function(){const t=this._dpadVector,e=this._moveVector;this.getDpad(t),this.getJoystick(a,e);const n=t.x||e.x,i=t.y||e.y,o=new THREE.Vector3;return Math.abs(n)>s&&(o.x+=n),Math.abs(i)>s&&(o.z+=i),o},isRotationActive:function(){if(!this.data.enabled||!this.isConnected())return!1;const t=this._lookVector;return this.getJoystick(h,t),Math.abs(t.x)>s||Math.abs(t.y)>s},updateRotation:function(t){if(!this.isRotationActive())return;const e=this.data,n=this.yaw,i=this.pitch;n.rotation.y=this.el.object3D.rotation.y,i.rotation.x=this.el.object3D.rotation.x;const o=this._lookVector;this.getJoystick(h,o),Math.abs(o.x)<=s&&(o.x=0),Math.abs(o.y)<=s&&(o.y=0),o.multiplyScalar(e.rotationSensitivity*t/1e3),n.rotation.y-=o.x,i.rotation.x-=o.y,i.rotation.x=Math.max(-Math.PI/2,Math.min(Math.PI/2,i.rotation.x)),this.el.object3D.rotation.set(i.rotation.x,n.rotation.y,0)},updateButtonState:function(){const t=this.getGamepad(r);if(this.data.enabled&&t)for(var e=0;e<t.buttons.length;e++)t.buttons[e].pressed&&!this.buttons[e]?this.emit(new o("gamepadbuttondown",e,t.buttons[e])):!t.buttons[e].pressed&&this.buttons[e]&&this.emit(new o("gamepadbuttonup",e,t.buttons[e])),this.buttons[e]=t.buttons[e].pressed;else Object.keys(this.buttons)&&(this.buttons={})},emit:function(t){this.el.emit(t.type,t),this.el.emit(t.type+":"+t.index,new o(t.type,t.index,t))},getGamepad:function(){const t=[],e=[];return function(n){const i=this.el.sceneEl.components["proxy-controls"],o=i&&i.isConnected()&&i.getGamepad(0);if(o)return o;t.length=0;for(let e=0;e<this.system.controllers.length;e++){const i=this.system.controllers[e],o=i?i.gamepad:null;if(t.push(o),o&&i.handedness===n)return o}const s=navigator.getGamepads?navigator.getGamepads():e;for(let t=0;t<s.length;t++){const e=s[t];if(e&&e.hand===n)return e}return t[0]||s[0]}}(),getButton:function(t){return this.getGamepad(r).buttons[t]},getAxis:function(t){return this.getGamepad(t>1?r:c).axes[t]},getJoystick:function(t,e){const n=this.getGamepad(t===a?c:r);if(!n)return e.set(0,0);if("xr-standard"===n.mapping)switch(t){case a:return e.set(n.axes[2],n.axes[3]);case h:return e.set(n.axes[2],0)}else switch(t){case a:return e.set(n.axes[0],n.axes[1]);case h:return e.set(n.axes[2],n.axes[3])}throw new Error('Unexpected joystick index "%d".',t)},getDpad:function(t){const e=this.getGamepad(c);return e&&e.buttons[i.DPAD_RIGHT]?t.set((e.buttons[i.DPAD_RIGHT].pressed?1:0)+(e.buttons[i.DPAD_LEFT].pressed?-1:0),(e.buttons[i.DPAD_UP].pressed?-1:0)+(e.buttons[i.DPAD_DOWN].pressed?1:0)):t.set(0,0)},isConnected:function(){const t=this.getGamepad(c);return!(!t||!t.connected)},getID:function(){return this.getGamepad(c).id}})},2406:function(t,e,n){n(3386),n(5062),n(2250),n(9048),n(3819),n(9893)},2250:function(t,e,n){n(7454);const i=window.KeyboardEvent;t.exports=AFRAME.registerComponent("keyboard-controls",{schema:{enabled:{default:!0},debug:{default:!1}},init:function(){this.dVelocity=new THREE.Vector3,this.localKeys={},this.listeners={keydown:this.onKeyDown.bind(this),keyup:this.onKeyUp.bind(this),blur:this.onBlur.bind(this),onContextMenu:this.onContextMenu.bind(this)}},isVelocityActive:function(){return this.data.enabled&&!!Object.keys(this.getKeys()).length},getVelocityDelta:function(){const t=this.data,e=this.getKeys();return this.dVelocity.set(0,0,0),t.enabled&&((e.KeyW||e.ArrowUp)&&(this.dVelocity.z-=1),(e.KeyA||e.ArrowLeft)&&(this.dVelocity.x-=1),(e.KeyS||e.ArrowDown)&&(this.dVelocity.z+=1),(e.KeyD||e.ArrowRight)&&(this.dVelocity.x+=1)),this.dVelocity.clone()},play:function(){this.attachEventListeners()},pause:function(){this.removeEventListeners()},attachEventListeners:function(){window.addEventListener("contextmenu",this.listeners.onContextMenu,!1),window.addEventListener("keydown",this.listeners.keydown,!1),window.addEventListener("keyup",this.listeners.keyup,!1),window.addEventListener("blur",this.listeners.blur,!1)},onContextMenu:function(){for(const t in this.localKeys)this.localKeys.hasOwnProperty(t)&&delete this.localKeys[t]},removeEventListeners:function(){window.removeEventListener("keydown",this.listeners.keydown),window.removeEventListener("keyup",this.listeners.keyup),window.removeEventListener("blur",this.listeners.blur)},onKeyDown:function(t){AFRAME.utils.shouldCaptureKeyEvent(t)&&(this.localKeys[t.code]=!0,this.emit(t))},onKeyUp:function(t){AFRAME.utils.shouldCaptureKeyEvent(t)&&(delete this.localKeys[t.code],this.emit(t))},onBlur:function(){for(const t in this.localKeys)this.localKeys.hasOwnProperty(t)&&delete this.localKeys[t]},emit:function(t){"__keyboard-controls-proxy"in t&&this.el.emit(t.type,t),this.el.emit(t.type+":"+t.code,new i(t.type,t)),this.data.debug&&console.log(t.type+":"+t.code)},isPressed:function(t){return t in this.getKeys()},getKeys:function(){return this.isProxied()?this.el.sceneEl.components["proxy-controls"].getKeyboard():this.localKeys},isProxied:function(){const t=this.el.sceneEl.components["proxy-controls"];return t&&t.isConnected()}})}}]);