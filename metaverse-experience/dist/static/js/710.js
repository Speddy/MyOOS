(self.webpackChunkmetaverse_experience=self.webpackChunkmetaverse_experience||[]).push([[710],{6443:function(e,t,n){var r=n(3687);r.shape2mesh=function(e){for(var t=new THREE.Object3D,n=0;n<e.shapes.length;n++){var i,a=e.shapes[n];switch(a.type){case r.Shape.types.SPHERE:var o=new THREE.SphereGeometry(a.radius,8,8);i=new THREE.Mesh(o,this.currentMaterial);break;case r.Shape.types.PARTICLE:i=new THREE.Mesh(this.particleGeo,this.particleMaterial);var s=this.settings;i.scale.set(s.particleSize,s.particleSize,s.particleSize);break;case r.Shape.types.PLANE:var c=new THREE.PlaneGeometry(10,10,4,4);i=new THREE.Object3D;var h=new THREE.Object3D,u=new THREE.Mesh(c,this.currentMaterial);u.scale.set(100,100,100),h.add(u),u.castShadow=!0,u.receiveShadow=!0,i.add(h);break;case r.Shape.types.BOX:var l=new THREE.BoxGeometry(2*a.halfExtents.x,2*a.halfExtents.y,2*a.halfExtents.z);i=new THREE.Mesh(l,this.currentMaterial);break;case r.Shape.types.CONVEXPOLYHEDRON:for(var m=new THREE.Geometry,d=0;d<a.vertices.length;d++){var p=a.vertices[d];m.vertices.push(new THREE.Vector3(p.x,p.y,p.z))}for(d=0;d<a.faces.length;d++)for(var f=a.faces[d],v=f[0],g=1;g<f.length-1;g++){var y=f[g],x=f[g+1];m.faces.push(new THREE.Face3(v,y,x))}m.computeBoundingSphere(),m.computeFaceNormals(),i=new THREE.Mesh(m,this.currentMaterial);break;case r.Shape.types.HEIGHTFIELD:c=new THREE.Geometry;for(var w=new r.Vec3,E=new r.Vec3,T=new r.Vec3,b=0;b<a.data.length-1;b++)for(var P=0;P<a.data[b].length-1;P++)for(var S=0;S<2;S++){a.getConvexTrianglePillar(b,P,0===S),w.copy(a.pillarConvex.vertices[0]),E.copy(a.pillarConvex.vertices[1]),T.copy(a.pillarConvex.vertices[2]),w.vadd(a.pillarOffset,w),E.vadd(a.pillarOffset,E),T.vadd(a.pillarOffset,T),c.vertices.push(new THREE.Vector3(w.x,w.y,w.z),new THREE.Vector3(E.x,E.y,E.z),new THREE.Vector3(T.x,T.y,T.z));d=c.vertices.length-3;c.faces.push(new THREE.Face3(d,d+1,d+2))}c.computeBoundingSphere(),c.computeFaceNormals(),i=new THREE.Mesh(c,this.currentMaterial);break;case r.Shape.types.TRIMESH:for(c=new THREE.Geometry,w=new r.Vec3,E=new r.Vec3,T=new r.Vec3,d=0;d<a.indices.length/3;d++){a.getTriangleVertices(d,w,E,T),c.vertices.push(new THREE.Vector3(w.x,w.y,w.z),new THREE.Vector3(E.x,E.y,E.z),new THREE.Vector3(T.x,T.y,T.z));g=c.vertices.length-3;c.faces.push(new THREE.Face3(g,g+1,g+2))}c.computeBoundingSphere(),c.computeFaceNormals(),i=new THREE.Mesh(c,this.currentMaterial);break;default:throw"Visual type not recognized: "+a.type}if(i.receiveShadow=!0,i.castShadow=!0,i.children)for(d=0;d<i.children.length;d++)if(i.children[d].castShadow=!0,i.children[d].receiveShadow=!0,i.children[d])for(g=0;g<i.children[d].length;g++)i.children[d].children[g].castShadow=!0,i.children[d].children[g].receiveShadow=!0;var C=e.shapeOffsets[n],A=e.shapeOrientations[n];i.position.set(C.x,C.y,C.z),i.quaternion.set(A.x,A.y,A.z,A.w),t.add(i)}return t},e.exports=r.shape2mesh},7270:function(e,t,n){"use strict";n.d(t,{J:function(){return c}});var r=n(3687),i=n(7223),a=function(){var e,t,n,r,a=new i.Pa4;function o(){this.tolerance=-1,this.faces=[],this.newFaces=[],this.assigned=new u,this.unassigned=new u,this.vertices=[]}function s(){this.normal=new i.Pa4,this.midpoint=new i.Pa4,this.area=0,this.constant=0,this.outside=null,this.mark=0,this.edge=null}function c(e,t){this.vertex=e,this.prev=null,this.next=null,this.twin=null,this.face=t}function h(e){this.point=e,this.prev=null,this.next=null,this.face=null}function u(){this.head=null,this.tail=null}return Object.assign(o.prototype,{setFromPoints:function(e){!0!==Array.isArray(e)&&console.error("THREE.ConvexHull: Points parameter is not an array."),e.length<4&&console.error("THREE.ConvexHull: The algorithm needs at least four points."),this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.vertices.push(new h(e[t]));return this.compute(),this},setFromObject:function(e){var t=[];return e.updateMatrixWorld(!0),e.traverse((function(e){var n,r,a,o=e.geometry;if(void 0!==o)if(o.isGeometry){var s=o.vertices;for(n=0,r=s.length;n<r;n++)(a=s[n].clone()).applyMatrix4(e.matrixWorld),t.push(a)}else if(o.isBufferGeometry){var c=o.attributes.position;if(void 0!==c)for(n=0,r=c.count;n<r;n++)(a=new i.Pa4).fromBufferAttribute(c,n).applyMatrix4(e.matrixWorld),t.push(a)}})),this.setFromPoints(t)},containsPoint:function(e){for(var t=this.faces,n=0,r=t.length;n<r;n++)if(t[n].distanceToPoint(e)>this.tolerance)return!1;return!0},intersectRay:function(e,t){for(var n=this.faces,r=-1/0,i=1/0,a=0,o=n.length;a<o;a++){var s=n[a],c=s.distanceToPoint(e.origin),h=s.normal.dot(e.direction);if(c>0&&h>=0)return null;var u=0!==h?-c/h:0;if(!(u<=0)&&(h>0?i=Math.min(u,i):r=Math.max(u,r),r>i))return null}return e.at(-1/0!==r?r:i,t),t},intersectsRay:function(e){return null!==this.intersectRay(e,a)},makeEmpty:function(){return this.faces=[],this.vertices=[],this},addVertexToFace:function(e,t){return e.face=t,null===t.outside?this.assigned.append(e):this.assigned.insertBefore(t.outside,e),t.outside=e,this},removeVertexFromFace:function(e,t){return e===t.outside&&(t.outside=null!==e.next&&e.next.face===t?e.next:null),this.assigned.remove(e),this},removeAllVerticesFromFace:function(e){if(null!==e.outside){for(var t=e.outside,n=e.outside;null!==n.next&&n.next.face===e;)n=n.next;return this.assigned.removeSubList(t,n),t.prev=n.next=null,e.outside=null,t}},deleteFaceVertices:function(e,t){var n=this.removeAllVerticesFromFace(e);if(void 0!==n)if(void 0===t)this.unassigned.appendChain(n);else{var r=n;do{var i=r.next;t.distanceToPoint(r.point)>this.tolerance?this.addVertexToFace(r,t):this.unassigned.append(r),r=i}while(null!==r)}return this},resolveUnassignedPoints:function(e){if(!1===this.unassigned.isEmpty()){var t=this.unassigned.first();do{for(var n=t.next,r=this.tolerance,i=null,a=0;a<e.length;a++){var o=e[a];if(0===o.mark){var s=o.distanceToPoint(t.point);if(s>r&&(r=s,i=o),r>1e3*this.tolerance)break}}null!==i&&this.addVertexToFace(t,i),t=n}while(null!==t)}return this},computeExtremes:function(){var e,t,n,r=new i.Pa4,a=new i.Pa4,o=[],s=[];for(e=0;e<3;e++)o[e]=s[e]=this.vertices[0];for(r.copy(this.vertices[0].point),a.copy(this.vertices[0].point),e=0,t=this.vertices.length;e<t;e++){var c=this.vertices[e],h=c.point;for(n=0;n<3;n++)h.getComponent(n)<r.getComponent(n)&&(r.setComponent(n,h.getComponent(n)),o[n]=c);for(n=0;n<3;n++)h.getComponent(n)>a.getComponent(n)&&(a.setComponent(n,h.getComponent(n)),s[n]=c)}return this.tolerance=3*Number.EPSILON*(Math.max(Math.abs(r.x),Math.abs(a.x))+Math.max(Math.abs(r.y),Math.abs(a.y))+Math.max(Math.abs(r.z),Math.abs(a.z))),{min:o,max:s}},computeInitialHull:function(){void 0===e&&(e=new i.Zzh,t=new i.JOQ,n=new i.Pa4);var r,a,o,c,h,u,l,m,d,p=this.vertices,f=this.computeExtremes(),v=f.min,g=f.max,y=0,x=0;for(u=0;u<3;u++)(d=g[u].point.getComponent(u)-v[u].point.getComponent(u))>y&&(y=d,x=u);for(y=0,e.set((a=v[x]).point,(o=g[x]).point),u=0,l=this.vertices.length;u<l;u++)(r=p[u])!==a&&r!==o&&(e.closestPointToPoint(r.point,!0,n),(d=n.distanceToSquared(r.point))>y&&(y=d,c=r));for(y=-1,t.setFromCoplanarPoints(a.point,o.point,c.point),u=0,l=this.vertices.length;u<l;u++)(r=p[u])!==a&&r!==o&&r!==c&&(d=Math.abs(t.distanceToPoint(r.point)))>y&&(y=d,h=r);var w=[];if(t.distanceToPoint(h.point)<0)for(w.push(s.create(a,o,c),s.create(h,o,a),s.create(h,c,o),s.create(h,a,c)),u=0;u<3;u++)m=(u+1)%3,w[u+1].getEdge(2).setTwin(w[0].getEdge(m)),w[u+1].getEdge(1).setTwin(w[m+1].getEdge(0));else for(w.push(s.create(a,c,o),s.create(h,a,o),s.create(h,o,c),s.create(h,c,a)),u=0;u<3;u++)m=(u+1)%3,w[u+1].getEdge(2).setTwin(w[0].getEdge((3-u)%3)),w[u+1].getEdge(0).setTwin(w[m+1].getEdge(1));for(u=0;u<4;u++)this.faces.push(w[u]);for(u=0,l=p.length;u<l;u++)if((r=p[u])!==a&&r!==o&&r!==c&&r!==h){y=this.tolerance;var E=null;for(m=0;m<4;m++)(d=this.faces[m].distanceToPoint(r.point))>y&&(y=d,E=this.faces[m]);null!==E&&this.addVertexToFace(r,E)}return this},reindexFaces:function(){for(var e=[],t=0;t<this.faces.length;t++){var n=this.faces[t];0===n.mark&&e.push(n)}return this.faces=e,this},nextVertexToAdd:function(){if(!1===this.assigned.isEmpty()){var e,t=0,n=this.assigned.first().face,r=n.outside;do{var i=n.distanceToPoint(r.point);i>t&&(t=i,e=r),r=r.next}while(null!==r&&r.face===n);return e}},computeHorizon:function(e,t,n,r){var i;this.deleteFaceVertices(n),n.mark=1,i=null===t?t=n.getEdge(0):t.next;do{var a=i.twin,o=a.face;0===o.mark&&(o.distanceToPoint(e)>this.tolerance?this.computeHorizon(e,a,o,r):r.push(i)),i=i.next}while(i!==t);return this},addAdjoiningFace:function(e,t){var n=s.create(e,t.tail(),t.head());return this.faces.push(n),n.getEdge(-1).setTwin(t.twin),n.getEdge(0)},addNewFaces:function(e,t){this.newFaces=[];for(var n=null,r=null,i=0;i<t.length;i++){var a=this.addAdjoiningFace(e,t[i]);null===n?n=a:a.next.setTwin(r),this.newFaces.push(a.face),r=a}return n.next.setTwin(r),this},addVertexToHull:function(e){var t=[];return this.unassigned.clear(),this.removeVertexFromFace(e,e.face),this.computeHorizon(e.point,null,e.face,t),this.addNewFaces(e,t),this.resolveUnassignedPoints(this.newFaces),this},cleanup:function(){return this.assigned.clear(),this.unassigned.clear(),this.newFaces=[],this},compute:function(){var e;for(this.computeInitialHull();void 0!==(e=this.nextVertexToAdd());)this.addVertexToHull(e);return this.reindexFaces(),this.cleanup(),this}}),Object.assign(s,{create:function(e,t,n){var r=new s,i=new c(e,r),a=new c(t,r),o=new c(n,r);return i.next=o.prev=a,a.next=i.prev=o,o.next=a.prev=i,r.edge=i,r.compute()}}),Object.assign(s.prototype,{getEdge:function(e){for(var t=this.edge;e>0;)t=t.next,e--;for(;e<0;)t=t.prev,e++;return t},compute:function(){void 0===r&&(r=new i.CJI);var e=this.edge.tail(),t=this.edge.head(),n=this.edge.next.head();return r.set(e.point,t.point,n.point),r.getNormal(this.normal),r.getMidpoint(this.midpoint),this.area=r.getArea(),this.constant=this.normal.dot(this.midpoint),this},distanceToPoint:function(e){return this.normal.dot(e)-this.constant}}),Object.assign(c.prototype,{head:function(){return this.vertex},tail:function(){return this.prev?this.prev.vertex:null},length:function(){var e=this.head(),t=this.tail();return null!==t?t.point.distanceTo(e.point):-1},lengthSquared:function(){var e=this.head(),t=this.tail();return null!==t?t.point.distanceToSquared(e.point):-1},setTwin:function(e){return this.twin=e,e.twin=this,this}}),Object.assign(u.prototype,{first:function(){return this.head},last:function(){return this.tail},clear:function(){return this.head=this.tail=null,this},insertBefore:function(e,t){return t.prev=e.prev,t.next=e,null===t.prev?this.head=t:t.prev.next=t,e.prev=t,this},insertAfter:function(e,t){return t.prev=e,t.next=e.next,null===t.next?this.tail=t:t.next.prev=t,e.next=t,this},append:function(e){return null===this.head?this.head=e:this.tail.next=e,e.prev=this.tail,e.next=null,this.tail=e,this},appendChain:function(e){for(null===this.head?this.head=e:this.tail.next=e,e.prev=this.tail;null!==e.next;)e=e.next;return this.tail=e,this},remove:function(e){return null===e.prev?this.head=e.next:e.prev.next=e.next,null===e.next?this.tail=e.prev:e.next.prev=e.prev,this},removeSubList:function(e,t){return null===e.prev?this.head=t.next:e.prev.next=t.next,null===t.next?this.tail=e.prev:t.next.prev=e.prev,this},isEmpty:function(){return null===this.head}}),o}(),o=Math.PI/2,s={BOX:"Box",CYLINDER:"Cylinder",SPHERE:"Sphere",HULL:"ConvexPolyhedron",MESH:"Trimesh"},c=function(e,t){var n,c,d,p;if((t=t||{}).type===s.BOX)return u(e);if(t.type===s.CYLINDER)return function(e,t){var n=["x","y","z"],a=t.cylinderAxis||"y",s=n.splice(n.indexOf(a),1)&&n,c=(new i.ZzF).setFromObject(e);if(!isFinite(c.min.lengthSq()))return null;var h=c.max[a]-c.min[a],u=.5*Math.max(c.max[s[0]]-c.min[s[0]],c.max[s[1]]-c.min[s[1]]),l=new r.Cylinder(u,u,h,12);return l._type=r.Shape.types.CYLINDER,l.radiusTop=u,l.radiusBottom=u,l.height=h,l.numSegments=12,l.orientation=new r.Quaternion,l.orientation.setFromEuler("y"===a?o:0,"z"===a?o:0,0,"XYZ").normalize(),l}(e,t);if(t.type===s.SPHERE)return function(e,t){if(t.sphereRadius)return new r.Sphere(t.sphereRadius);var n=l(e);return n?(n.computeBoundingSphere(),new r.Sphere(n.boundingSphere.radius)):null}(e,t);if(t.type===s.HULL)return function(e){var t=l(e);if(!t||!t.vertices.length)return null;for(var n=0;n<t.vertices.length;n++)t.vertices[n].x+=1e-4*(Math.random()-.5),t.vertices[n].y+=1e-4*(Math.random()-.5),t.vertices[n].z+=1e-4*(Math.random()-.5);var o=(new a).setFromObject(new i.Kj0(t)).faces,s=[],c=[];for(n=0;n<o.length;n++){var h=o[n],u=h.edge;do{var m=u.head().point;s.push(new r.Vec3(m.x,m.y,m.z)),c.push(new r.Vec3(h.normal.x,h.normal.y,h.normal.z)),u=u.next}while(u!==h.edge)}return new r.ConvexPolyhedron({vertices:s,normals:c})}(e);if(t.type===s.MESH)return(n=l(e))?function(e){var t=m(e);if(!t.length)return null;var n=Object.keys(t).map(Number);return new r.Trimesh(t,n)}(n):null;if(t.type)throw new Error('[CANNON.threeToCannon] Invalid type "%s".',t.type);if(!(n=l(e)))return null;switch(n.metadata?n.metadata.type:n.type){case"BoxGeometry":case"BoxBufferGeometry":return h(n);case"CylinderGeometry":case"CylinderBufferGeometry":return d=(c=n).metadata?c.metadata.parameters:c.parameters,(p=new r.Cylinder(d.radiusTop,d.radiusBottom,d.height,d.radialSegments))._type=r.Shape.types.CYLINDER,p.radiusTop=d.radiusTop,p.radiusBottom=d.radiusBottom,p.height=d.height,p.numSegments=d.radialSegments,p.orientation=new r.Quaternion,p.orientation.setFromEuler(i.ZX$.degToRad(-90),0,0,"XYZ").normalize(),p;case"PlaneGeometry":case"PlaneBufferGeometry":return function(e){e.computeBoundingBox();var t=e.boundingBox;return new r.Box(new r.Vec3((t.max.x-t.min.x)/2||.1,(t.max.y-t.min.y)/2||.1,(t.max.z-t.min.z)/2||.1))}(n);case"SphereGeometry":case"SphereBufferGeometry":return function(e){return new r.Sphere((e.metadata?e.metadata.parameters:e.parameters).radius)}(n);case"TubeGeometry":case"Geometry":case"BufferGeometry":return u(e);default:return console.warn('Unrecognized geometry: "%s". Using bounding box as shape.',n.type),h(n)}};function h(e){if(!m(e).length)return null;e.computeBoundingBox();var t=e.boundingBox;return new r.Box(new r.Vec3((t.max.x-t.min.x)/2,(t.max.y-t.min.y)/2,(t.max.z-t.min.z)/2))}function u(e){var t=e.clone();t.quaternion.set(0,0,0,1),t.updateMatrixWorld();var n=(new i.ZzF).setFromObject(t);if(!isFinite(n.min.lengthSq()))return null;var a=new r.Box(new r.Vec3((n.max.x-n.min.x)/2,(n.max.y-n.min.y)/2,(n.max.z-n.min.z)/2)),o=n.translate(t.position.negate()).getCenter(new i.Pa4);return o.lengthSq()&&(a.offset=o),a}function l(e){var t,n=function(e){var t=[];return e.traverse((function(e){"Mesh"===e.type&&t.push(e)})),t}(e),r=new i.ZXM,a=new i.ZXM;if(0===n.length)return null;if(1===n.length){var o=new i.Pa4,s=new i._fP,c=new i.Pa4;return n[0].geometry.isBufferGeometry?n[0].geometry.attributes.position&&n[0].geometry.attributes.position.itemSize>2&&r.fromBufferGeometry(n[0].geometry):r=n[0].geometry.clone(),r.metadata=n[0].geometry.metadata,n[0].updateMatrixWorld(),n[0].matrixWorld.decompose(o,s,c),r.scale(c.x,c.y,c.z)}for(;t=n.pop();)if(t.updateMatrixWorld(),t.geometry.isBufferGeometry){if(t.geometry.attributes.position&&t.geometry.attributes.position.itemSize>2){var h=new i.ZXM;h.fromBufferGeometry(t.geometry),a.merge(h,t.matrixWorld),h.dispose()}}else a.merge(t.geometry,t.matrixWorld);var u=new i.yGw;return u.scale(e.scale),a.applyMatrix(u),a}function m(e){return e.attributes||(e=(new i.u9r).fromGeometry(e)),(e.attributes.position||{}).array||[]}c.Type=s},974:function(e,t,n){const r=n(1389).CONSTRAINT;e.exports=AFRAME.registerComponent("ammo-constraint",{multiple:!0,schema:{type:{default:r.LOCK,oneOf:[r.LOCK,r.FIXED,r.SPRING,r.SLIDER,r.HINGE,r.CONE_TWIST,r.POINT_TO_POINT]},target:{type:"selector"},pivot:{type:"vec3"},targetPivot:{type:"vec3"},axis:{type:"vec3",default:{x:0,y:0,z:1}},targetAxis:{type:"vec3",default:{x:0,y:0,z:1}}},init:function(){this.system=this.el.sceneEl.systems.physics,this.constraint=null},remove:function(){this.constraint&&(this.system.removeConstraint(this.constraint),this.constraint=null)},update:function(){const e=this.el,t=this.data;this.remove(),e.body&&t.target.body?(this.constraint=this.createConstraint(),this.system.addConstraint(this.constraint)):(e.body?t.target:e).addEventListener("body-loaded",this.update.bind(this,{}),{once:!0})},createConstraint:function(){let e;const t=this.data,n=this.el.body,i=t.target.body,a=n.getCenterOfMassTransform().invert().op_mul(i.getWorldTransform()),o=new Ammo.btTransform;switch(o.setIdentity(),t.type){case r.LOCK:{e=new Ammo.btGeneric6DofConstraint(n,i,a,o,!0);const t=new Ammo.btVector3(0,0,0);e.setLinearLowerLimit(t),e.setLinearUpperLimit(t),e.setAngularLowerLimit(t),e.setAngularUpperLimit(t),Ammo.destroy(t);break}case r.FIXED:a.setRotation(n.getWorldTransform().getRotation()),o.setRotation(i.getWorldTransform().getRotation()),e=new Ammo.btFixedConstraint(n,i,a,o);break;case r.SPRING:e=new Ammo.btGeneric6DofSpringConstraint(n,i,a,o,!0);break;case r.SLIDER:e=new Ammo.btSliderConstraint(n,i,a,o,!0),e.setLowerLinLimit(-1),e.setUpperLinLimit(1);break;case r.HINGE:{const r=new Ammo.btVector3(t.pivot.x,t.pivot.y,t.pivot.z),a=new Ammo.btVector3(t.targetPivot.x,t.targetPivot.y,t.targetPivot.z),o=new Ammo.btVector3(t.axis.x,t.axis.y,t.axis.z),s=new Ammo.btVector3(t.targetAxis.x,t.targetAxis.y,t.targetAxis.z);e=new Ammo.btHingeConstraint(n,i,r,a,o,s,!0),Ammo.destroy(r),Ammo.destroy(a),Ammo.destroy(o),Ammo.destroy(s);break}case r.CONE_TWIST:{const r=new Ammo.btTransform;r.setIdentity(),r.getOrigin().setValue(t.pivot.x,t.pivot.y,t.pivot.z);const a=new Ammo.btTransform;a.setIdentity(),a.getOrigin().setValue(t.targetPivot.x,t.targetPivot.y,t.targetPivot.z),e=new Ammo.btConeTwistConstraint(n,i,r,a),Ammo.destroy(r),Ammo.destroy(a);break}case r.POINT_TO_POINT:{const r=new Ammo.btVector3(t.pivot.x,t.pivot.y,t.pivot.z),a=new Ammo.btVector3(t.targetPivot.x,t.targetPivot.y,t.targetPivot.z);e=new Ammo.btPoint2PointConstraint(n,i,r,a),Ammo.destroy(r),Ammo.destroy(a);break}default:throw new Error("[constraint] Unexpected type: "+t.type)}return Ammo.destroy(a),Ammo.destroy(o),e}})},6320:function(e,t,n){var r=n(3687);n(3410),n(8709),n(5855),n(2339),n(2712),n(7557),n(4538),n(974),n(3953),n(6821),n(2182),e.exports={registerAll:function(){console.warn("registerAll() is deprecated. Components are automatically registered.")}},window.CANNON=window.CANNON||r}}]);